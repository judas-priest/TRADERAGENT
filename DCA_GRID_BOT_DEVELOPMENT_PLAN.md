# –ü–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–≥–æ DCA-—Å–µ—Ç–æ—á–Ω–æ–≥–æ –±–æ—Ç–∞

**–í–µ—Ä—Å–∏—è:** 1.0
**–î–∞—Ç–∞:** 2026-02-05
**–°—Ç–∞—Ç—É—Å:** –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ö–æ–Ω—Ü–µ–ø—Ü–∏—è –∏ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#1-–∫–æ–Ω—Ü–µ–ø—Ü–∏—è-–∏-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
2. [–≠—Ç–∞–ø 0: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#2-—ç—Ç–∞–ø-0-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–∏-–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
3. [–≠—Ç–∞–ø 1: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –±–∞–∑–æ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã](#3-—ç—Ç–∞–ø-1-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞-–±–∞–∑–æ–≤–æ–π-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã)
4. [–≠—Ç–∞–ø 2: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π](#4-—ç—Ç–∞–ø-2-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-—Ç–æ—Ä–≥–æ–≤—ã—Ö-–º–æ–¥—É–ª–µ–π)
5. [–≠—Ç–∞–ø 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è, –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å](#5-—ç—Ç–∞–ø-3-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è-–∏-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
6. [–≠—Ç–∞–ø 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ](#6-—ç—Ç–∞–ø-4-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ-–∏-—Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ)
7. [–≠—Ç–∞–ø 5: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –¥–∞–ª—å–Ω–µ–π—à–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ](#7-—ç—Ç–∞–ø-5-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è-–∏-–¥–∞–ª—å–Ω–µ–π—à–µ–µ-—Ä–∞–∑–≤–∏—Ç–∏–µ)
8. [–û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏](#8-–æ—Ü–µ–Ω–∫–∞-—Ä–∏—Å–∫–æ–≤-–∏-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

---

## 1. –ö–æ–Ω—Ü–µ–ø—Ü–∏—è –∏ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### 1.1 –û–ø–∏—Å–∞–Ω–∏–µ –≥–∏–±—Ä–∏–¥–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

–ü—Ä–µ–¥–ª–∞–≥–∞—é—Ç—Å—è **—Ç—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞** –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ DCA –∏ Grid Trading:

#### **–í–∞—Ä–∏–∞–Ω—Ç 1: –°–µ—Ç–∫–∞ —Å DCA-—Å—Ç—Ä–∞—Ö–æ–≤–∫–æ–π (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**

**–ö–æ–Ω—Ü–µ–ø—Ü–∏—è:** –û—Å–Ω–æ–≤–Ω–∞—è —Å–µ—Ç–æ—á–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –∑–∞–¥–∞–Ω–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ —Ü–µ–Ω. –ü—Ä–∏ –ø—Ä–æ–±–æ–µ –Ω–∏–∂–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã —Å–µ—Ç–∫–∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –º–æ–¥—É–ª—å DCA –¥–ª—è —É—Å—Ä–µ–¥–Ω–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏. –ü–æ—Å–ª–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –æ–±—ä–µ–º–∞ —á–µ—Ä–µ–∑ DCA, —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è —Å–µ—Ç–∫–∞ —Å–æ —Å–º–µ—â–µ–Ω–Ω—ã–º–∏ —É—Ä–æ–≤–Ω—è–º–∏.

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω–∞—è —Å–µ—Ç–∫–∞ –∏–∑ N —É—Ä–æ–≤–Ω–µ–π –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [–Ω–∏–∂–Ω—è—è_–≥—Ä–∞–Ω–∏—Ü–∞, –≤–µ—Ä—Ö–Ω—è—è_–≥—Ä–∞–Ω–∏—Ü–∞]
- –ü—Ä–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–∏ –æ—Ä–¥–µ—Ä–∞ –Ω–∞ –ø–æ–∫—É–ø–∫—É ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –æ—Ä–¥–µ—Ä –Ω–∞ –ø—Ä–æ–¥–∞–∂—É –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –≤—ã—à–µ
- **–¢—Ä–∏–≥–≥–µ—Ä DCA:** –ï—Å–ª–∏ —Ü–µ–Ω–∞ –ø–∞–¥–∞–µ—Ç –Ω–∏–∂–µ –Ω–∏–∂–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã –Ω–∞ X% (–Ω–∞–ø—Ä–∏–º–µ—Ä, 3-5%)
- DCA-–º–æ–¥—É–ª—å –Ω–∞—á–∏–Ω–∞–µ—Ç —É—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ —Å –∑–∞–¥–∞–Ω–Ω—ã–º —à–∞–≥–æ–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–∞–∂–¥—ã–µ 2-3%)
- –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π DCA-–ø–æ–∫—É–ø–∫–∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Å—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –≤—Ö–æ–¥–∞
- –°–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è —Å–µ—Ç–∫–∞ –ø—Ä–æ–¥–∞–∂ —Å —É—á–µ—Ç–æ–º –Ω–æ–≤–æ–π —Å—Ä–µ–¥–Ω–µ–π —Ü–µ–Ω—ã + —Ü–µ–ª–µ–≤–∞—è –ø—Ä–∏–±—ã–ª—å

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ó–∞—â–∏—Ç–∞ –æ—Ç –∑–∞—Ç—è–∂–Ω—ã—Ö –ø–∞–¥–µ–Ω–∏–π
- –°–Ω–∏–∂–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–π —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ —Å–µ—Ç–æ—á–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ –≤ –±–æ–∫–æ–≤–æ–º —Ç—Ä–µ–Ω–¥–µ

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –¢—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ –∫–∞–ø–∏—Ç–∞–ª–∞ –¥–ª—è DCA
- –†–∏—Å–∫ "–∑–∞–º–æ—Ä–æ–∑–∫–∏" —Å—Ä–µ–¥—Å—Ç–≤ –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–º –ø–∞–¥–µ–Ω–∏–∏

---

#### **–í–∞—Ä–∏–∞–Ω—Ç 2: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –∫–∞–ø–∏—Ç–∞–ª–∞**

**–ö–æ–Ω—Ü–µ–ø—Ü–∏—è:** –ö–∞–ø–∏—Ç–∞–ª –¥–µ–ª–∏—Ç—Å—è –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏: X% –¥–ª—è Grid Trading, Y% –¥–ª—è DCA. –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –Ω–∞ –æ–¥–Ω–æ–π –ø–∞—Ä–µ.

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
- **Grid-—á–∞—Å—Ç—å (60% –∫–∞–ø–∏—Ç–∞–ª–∞):** –†–∞–±–æ—Ç–∞–µ—Ç –≤ —É–∑–∫–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ —Ü–µ–Ω —Å —á–∞—Å—Ç—ã–º–∏ —Å–¥–µ–ª–∫–∞–º–∏
- **DCA-—á–∞—Å—Ç—å (40% –∫–∞–ø–∏—Ç–∞–ª–∞):** –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–∏–ª—å–Ω—ã—Ö –ø–∞–¥–µ–Ω–∏—è—Ö, –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞
- –ü—Ä–∏–±—ã–ª—å –æ—Ç Grid —Ä–µ–∏–Ω–≤–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –≤ DCA –ø—Ä–∏ –±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –î–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∏—Å–∫–æ–≤
- Grid –ø—Ä–∏–Ω–æ—Å–∏—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—É—é –ø—Ä–∏–±—ã–ª—å
- DCA —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–π —Ç—Ä–µ–Ω–¥

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –°–ª–æ–∂–Ω–µ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–ø–∏—Ç–∞–ª–æ–º
- –í–æ–∑–º–æ–∂–Ω—ã –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ –æ–±–µ–∏—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

---

#### **–í–∞—Ä–∏–∞–Ω—Ç 3: –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å–µ—Ç–∫–∞ —Å –º–∏–∫—Ä–æ-DCA**

**–ö–æ–Ω—Ü–µ–ø—Ü–∏—è:** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Å–µ—Ç–∫–∞, –∫–æ—Ç–æ—Ä–∞—è "–ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç—Å—è" –∑–∞ —Ü–µ–Ω–æ–π. –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–∏ –æ—Ä–¥–µ—Ä–∞ –Ω–∞ –ø–æ–∫—É–ø–∫—É –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –Ω–µ–±–æ–ª—å—à–∞—è DCA-–ø–æ–∫—É–ø–∫–∞ (5-10% –æ—Ç –æ–±—ä–µ–º–∞ –æ—Ä–¥–µ—Ä–∞).

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
- –°–µ—Ç–∫–∞ –∏–∑ M —É—Ä–æ–≤–Ω–µ–π –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤–æ–∫—Ä—É–≥ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã
- –ü—Ä–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–∏ buy-–æ—Ä–¥–µ—Ä–∞: –≤—ã—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è sell-–æ—Ä–¥–µ—Ä + –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –º–∏–∫—Ä–æ-DCA –ø–æ–∫—É–ø–∫–∞
- –ú–∏–∫—Ä–æ-DCA —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Ä–µ–∑–µ—Ä–≤–Ω—É—é –ø–æ–∑–∏—Ü–∏—é
- –ü—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Ü–µ–Ω—ã –≤—ã—à–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞ ‚Äî —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å –ø—Ä–∏–±—ã–ª—å—é

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –∫ —Ä—ã–Ω–∫—É
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∏—Å–∫ "–∑–∞—Å—Ç—Ä–µ–≤–∞–Ω–∏—è"
- –ü–ª–∞–≤–Ω–æ–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞
- –í—ã—à–µ –∫–æ–º–∏—Å—Å–∏–æ–Ω–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã

---

### 1.2 –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–°–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ **—Å–æ–±—ã—Ç–∏–π–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ (Event-Driven Architecture)** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω–∞ **Mediator** –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                         DCA-Grid Trading Bot                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                    ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ                           ‚îÇ                           ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Bot Orchestrator‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§  Event Bus      ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ  Risk Manager   ‚îÇ
‚îÇ   (Mediator)     ‚îÇ       ‚îÇ  (Redis/Queue)  ‚îÇ       ‚îÇ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ                           ‚îÇ                         ‚îÇ
        ‚îÇ                           ‚îÇ                         ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Grid Engine     ‚îÇ       ‚îÇ   DCA Engine    ‚îÇ       ‚îÇ Config Manager  ‚îÇ
‚îÇ                  ‚îÇ       ‚îÇ                 ‚îÇ       ‚îÇ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ                           ‚îÇ                         ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                    ‚îÇ
                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚îÇ                   ‚îÇ                   ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ Exchange API   ‚îÇ  ‚îÇ   Database     ‚îÇ  ‚îÇ   Logger    ‚îÇ
        ‚îÇ Client (CCXT)  ‚îÇ  ‚îÇ   Manager      ‚îÇ  ‚îÇ             ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                ‚îÇ                   ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ   Binance     ‚îÇ   ‚îÇ  PostgreSQL    ‚îÇ
        ‚îÇ   Bybit       ‚îÇ   ‚îÇ  /SQLite       ‚îÇ
        ‚îÇ   OKX, etc.   ‚îÇ   ‚îÇ  + Redis       ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

                ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                ‚îÇ  Management Interface  ‚îÇ
                ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
                ‚îÇ  Telegram Bot          ‚îÇ
                ‚îÇ  (Optional: Web UI)    ‚îÇ
                ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

### 1.3 –û–ø–∏—Å–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

#### **1.3.1 Bot Orchestrator (–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä)**
- –ì–ª–∞–≤–Ω—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π
- –£–ø—Ä–∞–≤–ª—è–µ—Ç –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- –†–∞–∑—Ä–µ—à–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –º–µ–∂–¥—É Grid –∏ DCA
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–æ—Ç–∞ (Running, Paused, Stopped, Emergency)

#### **1.3.2 Event Bus (–®–∏–Ω–∞ —Å–æ–±—ã—Ç–∏–π)**
- Redis Pub/Sub –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏
- –°–æ–±—ã—Ç–∏—è: OrderFilled, PriceUpdate, BalanceChange, ErrorOccurred, etc.
- –ü–æ–∑–≤–æ–ª—è–µ—Ç –º–æ–¥—É–ª—è–º —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–µ–∑ –ø—Ä—è–º–æ–π —Å–≤—è–∑–∏

#### **1.3.3 Grid Engine (–°–µ—Ç–æ—á–Ω—ã–π –¥–≤–∏–∂–æ–∫)**
- –†–∞—Å—á–µ—Ç —É—Ä–æ–≤–Ω–µ–π —Å–µ—Ç–∫–∏
- –†–∞–∑–º–µ—â–µ–Ω–∏–µ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ª–∏–º–∏—Ç–Ω—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π/—Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–µ—Ç–∫–∏

#### **1.3.4 DCA Engine (–î–≤–∏–∂–æ–∫ —É—Å—Ä–µ–¥–Ω–µ–Ω–∏—è)**
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –¥–ª—è DCA
- –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ DCA-–ø–æ–∫—É–ø–æ–∫ –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º —É—Å–ª–æ–≤–∏—è–º
- –†–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–π —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤—ã–º–∏ —É—Ä–æ–≤–Ω—è–º–∏ –ø—Ä–æ–¥–∞–∂–∏

#### **1.3.5 Risk Manager (–ú–µ–Ω–µ–¥–∂–µ—Ä —Ä–∏—Å–∫–æ–≤)**
- –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –∫–∞–ø–∏—Ç–∞–ª–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –Ω–∞ –ø–æ–∑–∏—Ü–∏—é
- –°—Ç–æ–ø-–ª–æ—Å—Å –∏ —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–æ—Ä—Ç—Ñ–µ–ª—è
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ drawdown –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö

#### **1.3.6 Exchange API Client**
- –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∏—Ä–∂–∞–º–∏ —á–µ—Ä–µ–∑ CCXT
- –û–±—Ä–∞–±–æ—Ç–∫–∞ rate limits
- Retry-–ª–æ–≥–∏–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –¥–ª—è real-time –¥–∞–Ω–Ω—ã—Ö

#### **1.3.7 Database Manager**
- –•—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –±–æ—Ç–æ–≤
- –ò—Å—Ç–æ—Ä–∏—è –æ—Ä–¥–µ—Ä–æ–≤ –∏ —Å–¥–µ–ª–æ–∫
- –õ–æ–≥–∏ —Å–æ–±—ã—Ç–∏–π
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

#### **1.3.8 Config Manager**
- –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
- –ì–æ—Ä—è—á–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–≥–¥–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ)
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

#### **1.3.9 Telegram Bot Interface**
- –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (start/stop/pause/status)
- –ü—Ä–æ—Å–º–æ—Ç—Ä –±–∞–ª–∞–Ω—Å–æ–≤ –∏ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –≤–∞–∂–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö

---

### 1.4 –í—ã–±–æ—Ä —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ —Å—Ç–µ–∫–∞

#### **1.4.1 –ë—ç–∫–µ–Ω–¥ (–Ø–¥—Ä–æ –±–æ—Ç–∞)**

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: Python 3.11+**

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
- –ë–æ–≥–∞—Ç–∞—è —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤ –∏ trading (ccxt, pandas, numpy, ta-lib)
- Asyncio –¥–ª—è –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ–π –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã
- –ë—ã—Å—Ç—Ä–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ë–æ–ª—å—à–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã—Ö –±–∏—Ä–∂

**–û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:**
```python
ccxt>=4.2.0           # –†–∞–±–æ—Ç–∞ —Å –±–∏—Ä–∂–∞–º–∏
pandas>=2.1.0         # –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
numpy>=1.26.0         # –í—ã—á–∏—Å–ª–µ–Ω–∏—è
python-telegram-bot>=20.7  # Telegram –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
asyncio               # –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å (–≤—Å—Ç—Ä–æ–µ–Ω)
aiohttp>=3.9.0        # –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ HTTP –∑–∞–ø—Ä–æ—Å—ã
websockets>=12.0      # WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
pydantic>=2.5.0       # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:**
- **Node.js:** –•–æ—Ä–æ—à –¥–ª—è event-driven –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã, –Ω–æ –º–µ–Ω—å—à–µ –±–∏–±–ª–∏–æ—Ç–µ–∫ –¥–ª—è trading
- **Go:** –û—Ç–ª–∏—á–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –Ω–æ –º–µ–Ω—å—à–µ –≥–æ—Ç–æ–≤—ã—Ö —Ä–µ—à–µ–Ω–∏–π –∏ —Å–ª–æ–∂–Ω–µ–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏—è

---

#### **1.4.2 –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥**

**PostgreSQL 15+ (–æ—Å–Ω–æ–≤–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ)**
- –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ ACID-–≥–∞—Ä–∞–Ω—Ç–∏–∏
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ JSONB –¥–ª—è –≥–∏–±–∫–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä
- –û—Ç–ª–∏—á–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ì–æ—Ç–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è –¥–ª—è –±—ç–∫–∞–ø–∞

**–¢–∞–±–ª–∏—Ü—ã:**
- `bots` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –±–æ—Ç–æ–≤
- `orders` ‚Äî –≤—Å–µ –æ—Ä–¥–µ—Ä–∞ (pending, filled, cancelled)
- `trades` ‚Äî –∏—Å–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Å–¥–µ–ª–∫–∏
- `balances` ‚Äî –∏—Å—Ç–æ—Ä–∏—è –±–∞–ª–∞–Ω—Å–æ–≤
- `bot_states` ‚Äî —Å–Ω–∏–º–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–æ—Ç–∞
- `logs` ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏

**SQLite (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)**
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
- –õ–µ–≥–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ PostgreSQL –≤ production

**InfluxDB (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –º–µ—Ç—Ä–∏–∫)**
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤
- –û—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ü–µ–Ω, –æ–±—ä–µ–º–æ–≤, –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Grafana –∏–∑ –∫–æ—Ä–æ–±–∫–∏

---

#### **1.4.3 –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—á–µ—Ä–µ–¥–∏**

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: Redis 7+**

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- **Pub/Sub:** Event Bus –¥–ª—è –º–µ–∂–º–æ–¥—É–ª—å–Ω–æ–π –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏
- **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** –¢–µ–∫—É—â–∏–µ —Ü–µ–Ω—ã, –±–∞–ª–∞–Ω—Å—ã, —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—Ä–¥–µ—Ä–æ–≤
- **State storage:** –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–æ—Ç–∞ (–¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è)
- **Rate limiting:** –ö–æ–Ω—Ç—Ä–æ–ª—å —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API
- **Lock –º–µ—Ö–∞–Ω–∏–∑–º:** –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ race conditions

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:**
- **RabbitMQ:** –ë–æ–ª–µ–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π message broker, –Ω–æ –∏–∑–±—ã—Ç–æ—á–µ–Ω –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
- **Apache Kafka:** Overkill –¥–ª—è –æ–¥–Ω–æ–≥–æ –±–æ—Ç–∞

---

#### **1.4.4 –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è**

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: Telegram Bot (–ø–µ—Ä–≤–∞—è –æ—á–µ—Ä–µ–¥—å)**

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
- –ë—ã—Å—Ç—Ä–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (1-2 –¥–Ω—è)
- –î–æ—Å—Ç—É–ø —Å –ª—é–±–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Ö–æ—Å—Ç–∏–Ω–≥–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ UI

**–ö–æ–º–∞–Ω–¥—ã:**
```
/start - –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
/stop - –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞
/pause - –ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–æ—Ä–≥–æ–≤–ª—é
/status - –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
/balance - –ü–æ–∫–∞–∑–∞—Ç—å –±–∞–ª–∞–Ω—Å
/orders - –°–ø–∏—Å–æ–∫ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤
/pnl - Profit & Loss —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
/config - –ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
/emergency - –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π
```

**Web UI (–≤—Ç–æ—Ä–∞—è –æ—á–µ—Ä–µ–¥—å, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
- **Backend:** FastAPI (–ª–µ–≥–∫–∏–π, –±—ã—Å—Ç—Ä—ã–π, —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π)
- **Frontend:** React + TailwindCSS (—Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—Ç–µ–∫)
- **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:** Chart.js –∏–ª–∏ Recharts –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ PnL

---

#### **1.4.5 –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è**

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: Docker + Docker Compose**

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```yaml
services:
  bot:
    image: dca-grid-bot:latest
    depends_on:
      - postgres
      - redis
    volumes:
      - ./config:/app/config
      - ./logs:/app/logs
    env_file: .env

  postgres:
    image: postgres:15-alpine
    volumes:
      - postgres_data:/var/lib/postgresql/data

  redis:
    image: redis:7-alpine
    volumes:
      - redis_data:/data

  # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
  grafana:
    image: grafana/grafana:latest
    depends_on:
      - influxdb
    ports:
      - "3000:3000"

  influxdb:
    image: influxdb:2.7-alpine
    volumes:
      - influxdb_data:/var/lib/influxdb2
```

---

#### **1.4.6 –°–µ—Ä–≤–µ—Ä**

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: VPS Linux (Ubuntu 22.04 LTS)**

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- **CPU:** 2 vCPU
- **RAM:** 4 GB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 8 GB)
- **SSD:** 50 GB
- **Network:** –°—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –Ω–∏–∑–∫–æ–π –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å—é –∫ –±–∏—Ä–∂–µ

**–ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã:**
- **DigitalOcean:** $24/–º–µ—Å (4GB RAM, 2 vCPU) ‚Äî –ø—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **Hetzner:** ‚Ç¨9.90/–º–µ—Å (8GB RAM, 2 vCPU) ‚Äî –ª—É—á—à–µ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ü–µ–Ω–∞/–∫–∞—á–µ—Å—Ç–≤–æ
- **Vultr:** $24/–º–µ—Å ‚Äî —Ö–æ—Ä–æ—à–∞—è —Å–µ—Ç—å
- **AWS/GCP:** –î–æ—Ä–æ–∂–µ, –Ω–æ —Å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–º–∏ –æ–ø—Ü–∏—è–º–∏

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã:**
- Raspberry Pi 4 (8GB) ‚Äî –¥–ª—è –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ–º–∞
- NAS (Synology, QNAP) ‚Äî –µ—Å–ª–∏ —É–∂–µ –µ—Å—Ç—å

---

## 2. –≠—Ç–∞–ø 0: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–¥–∞—á–∞ 0.1: –ê–Ω–∞–ª–∏–∑ –∏ –≤—ã–±–æ—Ä —Ü–µ–ª–µ–≤—ã—Ö –±–∏—Ä–∂

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –≤—ã–±–æ—Ä–∞:**
1. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ CCXT (–ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
2. –ù–∞–¥–µ–∂–Ω–æ–µ API —Å WebSocket
3. –ê–¥–µ–∫–≤–∞—Ç–Ω—ã–µ –∫–æ–º–∏—Å—Å–∏–∏ (maker/taker)
4. –ù–∞–ª–∏—á–∏–µ testnet –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
5. –õ–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å –Ω–∞ —Ü–µ–ª–µ–≤—ã—Ö –ø–∞—Ä–∞—Ö

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –±–∏—Ä–∂–∏ –¥–ª—è —Å—Ç–∞—Ä—Ç–∞:**

#### **1. Binance (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1)**
- ‚úÖ –û—Ç–ª–∏—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤ CCXT
- ‚úÖ Testnet –¥–æ—Å—Ç—É–ø–µ–Ω (testnet.binance.vision)
- ‚úÖ –ù–∏–∑–∫–∏–µ –∫–æ–º–∏—Å—Å–∏–∏ (0.1% spot, 0.075% —Å BNB)
- ‚úÖ –í—ã—Å–æ–∫–∞—è –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å
- ‚úÖ –ù–∞–¥–µ–∂–Ω–æ–µ WebSocket API
- ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º (VPN –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è)

**Rate Limits:**
- REST API: 1200 requests/minute
- WebSocket: 5 connections, 100 subscriptions per connection

#### **2. Bybit (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2)**
- ‚úÖ –•–æ—Ä–æ—à–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤ CCXT
- ‚úÖ Testnet: testnet.bybit.com
- ‚úÖ –ù–∏–∑–∫–∏–µ –∫–æ–º–∏—Å—Å–∏–∏ (0.1% maker/taker)
- ‚úÖ Friendly –¥–ª—è retail —Ç—Ä–µ–π–¥–µ—Ä–æ–≤
- ‚úÖ Unified Trading Account (—É–¥–æ–±–Ω–æ)

**Rate Limits:**
- REST API: 120 requests/minute (API key based)

#### **3. OKX (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3)**
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ CCXT
- ‚úÖ –î–µ–º–æ-–∞–∫–∫–∞—É–Ω—Ç –¥–æ—Å—Ç—É–ø–µ–Ω
- ‚úÖ –ù–∏–∑–∫–∏–µ –∫–æ–º–∏—Å—Å–∏–∏
- ‚ö†Ô∏è –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ–µ API

**–¢–∏–ø—ã –æ—Ä–¥–µ—Ä–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
- ‚úÖ Limit orders (–æ—Å–Ω–æ–≤–∞ –¥–ª—è Grid)
- ‚úÖ Market orders (–¥–ª—è DCA –ø—Ä–∏ —Å—Ä–æ—á–Ω–æ—Å—Ç–∏)
- ‚úÖ Post-only orders (–≤–∞–∂–Ω–æ –¥–ª—è Grid, —á—Ç–æ–±—ã –±—ã—Ç—å maker)
- ‚ö†Ô∏è OCO orders (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è —Å—Ç–æ–ø-–ª–æ—Å—Å–æ–≤)

**–ü—Ä–∏–º–µ—Ä –ø—Ä–æ–≤–µ—Ä–∫–∏ —á–µ—Ä–µ–∑ CCXT:**
```python
import ccxt

exchange = ccxt.binance({
    'apiKey': 'YOUR_API_KEY',
    'secret': 'YOUR_SECRET',
    'enableRateLimit': True,
    'options': {'defaultType': 'spot'}
})

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
print(exchange.has['createLimitOrder'])  # True
print(exchange.has['createMarketOrder']) # True
print(exchange.has['fetchOpenOrders'])   # True
print(exchange.has['fetchMyTrades'])     # True
print(exchange.has['fetchBalance'])      # True
```

---

### –ó–∞–¥–∞—á–∞ 0.2: –î–µ—Ç–∞–ª—å–Ω–æ–µ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**PostgreSQL Schema:**

```sql
-- –¢–∞–±–ª–∏—Ü–∞ –±–æ—Ç–æ–≤
CREATE TABLE bots (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    exchange VARCHAR(50) NOT NULL,  -- 'binance', 'bybit', etc.
    symbol VARCHAR(20) NOT NULL,    -- 'BTC/USDT'
    strategy_type VARCHAR(20) NOT NULL, -- 'grid', 'dca', 'hybrid'
    config JSONB NOT NULL,          -- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (—Å–º. –Ω–∏–∂–µ)
    state VARCHAR(20) DEFAULT 'stopped', -- 'running', 'paused', 'stopped', 'error'
    total_capital DECIMAL(20, 8) NOT NULL,
    available_capital DECIMAL(20, 8) NOT NULL,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW(),
    UNIQUE(name)
);

-- –¢–∞–±–ª–∏—Ü–∞ API –∫–ª—é—á–µ–π (—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ)
CREATE TABLE exchange_credentials (
    id SERIAL PRIMARY KEY,
    bot_id INTEGER REFERENCES bots(id) ON DELETE CASCADE,
    exchange VARCHAR(50) NOT NULL,
    api_key_encrypted TEXT NOT NULL,
    api_secret_encrypted TEXT NOT NULL,
    passphrase_encrypted TEXT,  -- –î–ª—è OKX –∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –¥—Ä—É–≥–∏—Ö
    created_at TIMESTAMP DEFAULT NOW()
);

-- –¢–∞–±–ª–∏—Ü–∞ –æ—Ä–¥–µ—Ä–æ–≤
CREATE TABLE orders (
    id SERIAL PRIMARY KEY,
    bot_id INTEGER REFERENCES bots(id) ON DELETE CASCADE,
    exchange_order_id VARCHAR(100),
    symbol VARCHAR(20) NOT NULL,
    type VARCHAR(10) NOT NULL,  -- 'limit', 'market'
    side VARCHAR(10) NOT NULL,  -- 'buy', 'sell'
    price DECIMAL(20, 8),
    amount DECIMAL(20, 8) NOT NULL,
    filled DECIMAL(20, 8) DEFAULT 0,
    remaining DECIMAL(20, 8),
    status VARCHAR(20) NOT NULL, -- 'open', 'closed', 'canceled', 'expired'
    strategy_component VARCHAR(20), -- 'grid', 'dca', 'manual'
    grid_level INTEGER,  -- –£—Ä–æ–≤–µ–Ω—å —Å–µ—Ç–∫–∏ (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ)
    dca_step INTEGER,    -- –®–∞–≥ DCA (–µ—Å–ª–∏ –ø—Ä–∏–º–µ–Ω–∏–º–æ)
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW(),
    closed_at TIMESTAMP
);

CREATE INDEX idx_orders_bot_status ON orders(bot_id, status);
CREATE INDEX idx_orders_exchange_id ON orders(exchange_order_id);

-- –¢–∞–±–ª–∏—Ü–∞ —Å–¥–µ–ª–æ–∫ (filled orders)
CREATE TABLE trades (
    id SERIAL PRIMARY KEY,
    bot_id INTEGER REFERENCES bots(id) ON DELETE CASCADE,
    order_id INTEGER REFERENCES orders(id),
    exchange_trade_id VARCHAR(100),
    symbol VARCHAR(20) NOT NULL,
    side VARCHAR(10) NOT NULL,
    price DECIMAL(20, 8) NOT NULL,
    amount DECIMAL(20, 8) NOT NULL,
    fee DECIMAL(20, 8),
    fee_currency VARCHAR(10),
    realized_pnl DECIMAL(20, 8), -- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–∏–±—ã–ª—å/—É–±—ã—Ç–æ–∫
    timestamp TIMESTAMP NOT NULL,
    created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_trades_bot_timestamp ON trades(bot_id, timestamp);

-- –¢–∞–±–ª–∏—Ü–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –±–æ—Ç–∞ (snapshots)
CREATE TABLE bot_states (
    id SERIAL PRIMARY KEY,
    bot_id INTEGER REFERENCES bots(id) ON DELETE CASCADE,
    state_data JSONB NOT NULL, -- –ü–æ–ª–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: –ø–æ–∑–∏—Ü–∏–∏, —Å—Ä–µ–¥–Ω–∏–µ —Ü–µ–Ω—ã, –∏ —Ç.–¥.
    timestamp TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_bot_states_bot_timestamp ON bot_states(bot_id, timestamp DESC);

-- –¢–∞–±–ª–∏—Ü–∞ –ª–æ–≥–æ–≤
CREATE TABLE logs (
    id SERIAL PRIMARY KEY,
    bot_id INTEGER REFERENCES bots(id) ON DELETE CASCADE,
    level VARCHAR(10) NOT NULL, -- 'DEBUG', 'INFO', 'WARNING', 'ERROR', 'CRITICAL'
    message TEXT NOT NULL,
    context JSONB,
    timestamp TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_logs_bot_level_timestamp ON logs(bot_id, level, timestamp DESC);

-- –¢–∞–±–ª–∏—Ü–∞ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
CREATE TABLE performance_metrics (
    id SERIAL PRIMARY KEY,
    bot_id INTEGER REFERENCES bots(id) ON DELETE CASCADE,
    total_trades INTEGER DEFAULT 0,
    winning_trades INTEGER DEFAULT 0,
    losing_trades INTEGER DEFAULT 0,
    total_pnl DECIMAL(20, 8) DEFAULT 0,
    total_fees DECIMAL(20, 8) DEFAULT 0,
    max_drawdown DECIMAL(10, 4) DEFAULT 0, -- –í –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
    current_drawdown DECIMAL(10, 4) DEFAULT 0,
    sharpe_ratio DECIMAL(10, 4),
    updated_at TIMESTAMP DEFAULT NOW()
);
```

---

### –ó–∞–¥–∞—á–∞ 0.3: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –±–æ—Ç–∞

**–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (config.yaml):**

```yaml
bot:
  name: "BTC-USDT-Grid-DCA-Bot-1"
  exchange: "binance"
  symbol: "BTC/USDT"
  strategy_type: "hybrid"  # 'grid', 'dca', 'hybrid'

capital:
  total_capital_usdt: 1000.0
  grid_allocation_percent: 60  # 60% –¥–ª—è Grid
  dca_allocation_percent: 40   # 40% –¥–ª—è DCA

# Grid Strategy –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
grid:
  enabled: true
  type: "static"  # 'static' –∏–ª–∏ 'dynamic'

  # –î–∏–∞–ø–∞–∑–æ–Ω —Å–µ—Ç–∫–∏
  upper_price: 45000.0
  lower_price: 40000.0

  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Ä–æ–≤–Ω–µ–π (—á–µ–º –±–æ–ª—å—à–µ, —Ç–µ–º —á–∞—â–µ —Å–¥–µ–ª–∫–∏, –Ω–æ –º–µ–Ω—å—à–µ –æ–±—ä–µ–º)
  grid_levels: 20

  # –ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∏–±—ã–ª–∏ –Ω–∞ —É—Ä–æ–≤–µ–Ω—å (–µ—Å–ª–∏ dynamic)
  profit_per_level_percent: 0.5

  # –¢–∏–ø –æ—Ä–¥–µ—Ä–æ–≤
  order_type: "limit"  # 'limit' or 'market'

  # Post-only –æ—Ä–¥–µ—Ä–∞ (–±—ã—Ç—å maker)
  post_only: true

  # –†–µ–∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–±—ã–ª–∏
  reinvest_profit: true
  reinvest_threshold_usdt: 50.0  # –†–µ–∏–Ω–≤–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å, –∫–æ–≥–¥–∞ –Ω–∞–∫–æ–ø–∏—Ç—Å—è >= $50

# DCA Strategy –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
dca:
  enabled: true

  # –¢—Ä–∏–≥–≥–µ—Ä –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
  trigger_type: "price_drop"  # 'price_drop', 'manual', 'schedule'

  # –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –Ω–∏–∂–µ –Ω–∏–∂–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã Grid –Ω–∞ X%
  activation_drop_percent: 5.0

  # –®–∞–≥ —É—Å—Ä–µ–¥–Ω–µ–Ω–∏—è (–ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø–æ–∫—É–ø–∫–∏)
  step_percent: 3.0

  # –û–±—ä–µ–º –∫–∞–∂–¥–æ–π DCA –ø–æ–∫—É–ø–∫–∏ (USDT)
  order_amount_usdt: 50.0

  # –ò–ª–∏ –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–≥–æ DCA –∫–∞–ø–∏—Ç–∞–ª–∞
  order_amount_percent: 10.0

  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ DCA —à–∞–≥–æ–≤
  max_dca_orders: 5

  # –¶–µ–ª–µ–≤–∞—è –ø—Ä–∏–±—ã–ª—å –ø–æ—Å–ª–µ DCA (–ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç —Å—Ä–µ–¥–Ω–µ–π —Ü–µ–Ω—ã)
  target_profit_percent: 5.0

  # –ñ–¥–∞—Ç—å –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–µ–π DCA –ø–æ–∫—É–ø–∫–æ–π (—Å–µ–∫—É–Ω–¥—ã)
  cooldown_seconds: 300

# Risk Management –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
risk:
  # –°—Ç–æ–ø-–ª–æ—Å—Å –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–æ—Ä—Ç—Ñ–µ–ª—è (–ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –∫–∞–ø–∏—Ç–∞–ª–∞)
  max_drawdown_percent: 15.0

  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Å—Ç–æ–ø-–ª–æ—Å—Å–∞
  auto_stop_on_max_drawdown: true

  # Take-profit –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–æ—Ä—Ç—Ñ–µ–ª—è
  take_profit_percent: 20.0

  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤
  max_open_orders: 50

  # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–±—ä–µ–º –æ—Ä–¥–µ—Ä–∞ (–¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –æ—à–∏–±–æ–∫ –±–∏—Ä–∂–∏)
  min_order_amount_usdt: 10.0

# –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
advanced:
  # –†–µ–∂–∏–º –±–æ—Ç–∞
  mode: "live"  # 'paper' (–±—É–º–∞–∂–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è), 'live'

  # WebSocket –∏–ª–∏ polling –¥–ª—è —Ü–µ–Ω
  price_update_method: "websocket"  # 'websocket', 'polling'
  polling_interval_seconds: 5

  # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
  max_api_retries: 3
  retry_delay_seconds: 5

  # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
  log_level: "INFO"  # 'DEBUG', 'INFO', 'WARNING', 'ERROR'
  log_to_file: true
  log_file_path: "./logs/bot.log"

  # Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
  telegram:
    enabled: true
    bot_token: "${TELEGRAM_BOT_TOKEN}"  # –ò–∑ env
    chat_id: "${TELEGRAM_CHAT_ID}"
    notify_on_order_fill: true
    notify_on_error: true
    notify_on_dca_trigger: true

# –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Grid + DCA (–í–∞—Ä–∏–∞–Ω—Ç 1)
integration:
  strategy: "grid_with_dca_fallback"  # –°–º. —Ä–∞–∑–¥–µ–ª 1.1

  # –ü—Ä–∏ DCA ‚Äî –ø–µ—Ä–µ—Å—Ç—Ä–æ–∏—Ç—å Grid?
  rebuild_grid_after_dca: true

  # –ù–æ–≤–∞—è –Ω–∏–∂–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ = —Å—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –ø–æ—Å–ª–µ DCA - X%
  new_grid_lower_offset_percent: 5.0

  # –ù–æ–≤–∞—è –≤–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ = —Å—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –ø–æ—Å–ª–µ DCA + Y%
  new_grid_upper_offset_percent: 10.0
```

**–ü—Ä–∏–º–µ—Ä .env —Ñ–∞–π–ª–∞ (—Å–µ–∫—Ä–µ—Ç—ã):**
```bash
# Exchange API Keys
BINANCE_API_KEY=your_api_key_here
BINANCE_API_SECRET=your_api_secret_here

# Encryption key –¥–ª—è –ë–î (32 –±–∞–π—Ç–∞ hex)
DB_ENCRYPTION_KEY=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef

# Database
DATABASE_URL=postgresql://user:password@localhost:5432/dcagrid_bot
REDIS_URL=redis://localhost:6379/0

# Telegram
TELEGRAM_BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz
TELEGRAM_CHAT_ID=123456789
```

---

### –ó–∞–¥–∞—á–∞ 0.4: –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è API-–∫–ª—é—á–µ–π

**–ü–æ–¥—Ö–æ–¥: –°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å Fernet (cryptography library)**

**–ü—Ä–∏–Ω—Ü–∏–ø—ã:**
1. API –∫–ª—é—á–∏ **–ù–ò–ö–û–ì–î–ê** –Ω–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ plaintext
2. –ú–∞—Å—Ç–µ—Ä-–∫–ª—é—á —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (`.env` —Ñ–∞–π–ª –ù–ï –≤ git)
3. –ö–∞–∂–¥—ã–π –∫–ª—é—á —à–∏—Ñ—Ä—É–µ—Ç—Å—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ
4. Rotation –∫–ª—é—á–µ–π —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è (Python):**

```python
from cryptography.fernet import Fernet
import os
import base64

class SecureCredentialManager:
    """–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ credentials"""

    def __init__(self):
        # –ú–∞—Å—Ç–µ—Ä-–∫–ª—é—á –∏–∑ env (–∏–ª–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ)
        key = os.getenv('DB_ENCRYPTION_KEY')
        if not key:
            raise ValueError("DB_ENCRYPTION_KEY not set in environment")

        self.cipher = Fernet(key.encode())

    def encrypt_credential(self, plaintext: str) -> str:
        """–®–∏—Ñ—Ä—É–µ—Ç credential"""
        if not plaintext:
            return ""
        encrypted = self.cipher.encrypt(plaintext.encode())
        return base64.b64encode(encrypted).decode()

    def decrypt_credential(self, encrypted: str) -> str:
        """–†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞–µ—Ç credential"""
        if not encrypted:
            return ""
        decoded = base64.b64decode(encrypted.encode())
        decrypted = self.cipher.decrypt(decoded)
        return decrypted.decode()

    @staticmethod
    def generate_encryption_key() -> str:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–π –∫–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è"""
        return Fernet.generate_key().decode()

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
cred_manager = SecureCredentialManager()

# –ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
api_key_encrypted = cred_manager.encrypt_credential("actual_api_key")
# –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –ë–î: api_key_encrypted

# –ü—Ä–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–∏
api_key = cred_manager.decrypt_credential(api_key_encrypted)
# –ò—Å–ø–æ–ª—å–∑—É–µ–º api_key –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∏—Ä–∂–µ
```

**–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**

1. **–§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞:**
   - `.env` —Ñ–∞–π–ª —Å permissions 600 (—Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª–µ—Ü)
   - –ù–µ –∫–æ–º–º–∏—Ç–∏—Ç—å `.env` –≤ git (–¥–æ–±–∞–≤–∏—Ç—å –≤ `.gitignore`)

2. **Docker secrets (production):**
   ```yaml
   services:
     bot:
       secrets:
         - db_encryption_key
         - binance_api_key
         - binance_api_secret

   secrets:
     db_encryption_key:
       file: ./secrets/db_encryption_key.txt
     binance_api_key:
       file: ./secrets/binance_api_key.txt
     binance_api_secret:
       file: ./secrets/binance_api_secret.txt
   ```

3. **API Key permissions:**
   - –†–∞–∑—Ä–µ—à–∏—Ç—å **–¢–û–õ–¨–ö–û** —Ç–æ—Ä–≥–æ–≤–ª—é (spot trading)
   - **–ó–ê–ü–†–ï–¢–ò–¢–¨** –≤—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤ (withdrawal)
   - Whitelist IP —Å–µ—Ä–≤–µ—Ä–∞ (–µ—Å–ª–∏ –±–∏—Ä–∂–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç)

4. **–†–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π:**
   - –ú–µ–Ω—è—Ç—å API –∫–ª—é—á–∏ —Ä–∞–∑ –≤ 3-6 –º–µ—Å—è—Ü–µ–≤
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–µ–π –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ –±–∏—Ä–∂–∏

---

## 3. –≠—Ç–∞–ø 1: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –±–∞–∑–æ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

### –ó–∞–¥–∞—á–∞ 1.1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞, –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è, —Ñ–∞–π–ª–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:**

```
dca-grid-bot/
‚îÇ
‚îú‚îÄ‚îÄ .env.example              # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ setup.py
‚îÇ
‚îú‚îÄ‚îÄ config/                   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ config.yaml.example
‚îÇ   ‚îî‚îÄ‚îÄ logging.yaml
‚îÇ
‚îú‚îÄ‚îÄ secrets/                  # –°–µ–∫—Ä–µ—Ç—ã (–ù–ï –≤ git!)
‚îÇ   ‚îú‚îÄ‚îÄ .gitkeep
‚îÇ   ‚îî‚îÄ‚îÄ (–∫–ª—é—á–∏ –∑–¥–µ—Å—å)
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ main.py              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ core/                # –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ orchestrator.py   # Bot Orchestrator
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ event_bus.py      # Event Bus
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ config.py         # Config Manager
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ exchange/            # –†–∞–±–æ—Ç–∞ —Å –±–∏—Ä–∂–∞–º–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ client.py         # Exchange API Client
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ binance.py        # –°–ø–µ—Ü–∏—Ñ–∏–∫–∞ Binance
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ bybit.py          # –°–ø–µ—Ü–∏—Ñ–∏–∫–∞ Bybit
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ strategies/          # –¢–æ—Ä–≥–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ grid_engine.py    # Grid Strategy
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dca_engine.py     # DCA Strategy
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ hybrid.py         # Hybrid Strategy
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ risk/                # Risk Management
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ manager.py
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ database/            # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ manager.py        # Database Manager
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py         # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ migrations/       # Alembic –º–∏–≥—Ä–∞—Ü–∏–∏
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ security/            # –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ credentials.py    # Secure Credential Manager
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ interfaces/          # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ telegram_bot.py   # Telegram Bot
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ web_api.py        # FastAPI (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ utils/               # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ logger.py         # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ       ‚îú‚îÄ‚îÄ helpers.py
‚îÇ       ‚îî‚îÄ‚îÄ validators.py
‚îÇ
‚îú‚îÄ‚îÄ tests/                   # –¢–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ unit/
‚îÇ   ‚îú‚îÄ‚îÄ integration/
‚îÇ   ‚îî‚îÄ‚îÄ backtest/
‚îÇ
‚îú‚îÄ‚îÄ scripts/                 # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ init_db.py
‚îÇ   ‚îú‚îÄ‚îÄ generate_keys.py
‚îÇ   ‚îî‚îÄ‚îÄ deploy.sh
‚îÇ
‚îú‚îÄ‚îÄ logs/                    # –õ–æ–≥–∏ (–ù–ï –≤ git!)
‚îÇ   ‚îî‚îÄ‚îÄ .gitkeep
‚îÇ
‚îî‚îÄ‚îÄ docs/                    # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
    ‚îú‚îÄ‚îÄ architecture.md
    ‚îú‚îÄ‚îÄ api.md
    ‚îî‚îÄ‚îÄ deployment.md
```

**requirements.txt:**
```txt
# Core
python>=3.11

# Trading
ccxt>=4.2.0
pandas>=2.1.0
numpy>=1.26.0
ta-lib>=0.4.28

# Async
aiohttp>=3.9.0
websockets>=12.0
asyncio-mqtt>=0.16.0

# Database
sqlalchemy>=2.0.0
alembic>=1.13.0
psycopg2-binary>=2.9.0
asyncpg>=0.29.0

# Cache/Queue
redis>=5.0.0
aioredis>=2.0.0

# Security
cryptography>=41.0.0
pydantic>=2.5.0
pydantic-settings>=2.1.0

# Telegram
python-telegram-bot>=20.7

# Web (optional)
fastapi>=0.109.0
uvicorn>=0.27.0

# Monitoring
prometheus-client>=0.19.0

# Utils
pyyaml>=6.0
python-dotenv>=1.0.0
click>=8.1.0

# Testing
pytest>=7.4.0
pytest-asyncio>=0.21.0
pytest-cov>=4.1.0
pytest-mock>=3.12.0

# Development
black>=23.12.0
flake8>=7.0.0
mypy>=1.8.0
```

**–ö–æ–º–∞–Ω–¥—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:**
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python3.11 -m venv venv
source venv/bin/activate  # Linux/Mac
# –∏–ª–∏
venv\Scripts\activate  # Windows

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install --upgrade pip
pip install -r requirements.txt

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ TA-Lib (—Ç—Ä–µ–±—É–µ—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ C –±–∏–±–ª–∏–æ—Ç–µ–∫–∏)
# Ubuntu/Debian:
sudo apt-get install -y ta-lib
# MacOS:
brew install ta-lib

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
cp config/config.yaml.example config/config.yaml
cp .env.example .env

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
python scripts/generate_keys.py

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
python scripts/init_db.py
```

---

### –ó–∞–¥–∞—á–∞ 1.2: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –º–æ–¥—É–ª—è ExchangeAPIClient

**–û–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ CCXT —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–æ–π:**

```python
# src/exchange/client.py

import ccxt
import asyncio
from typing import Dict, List, Optional, Any
from decimal import Decimal
import logging
from datetime import datetime, timedelta

logger = logging.getLogger(__name__)


class ExchangeAPIClient:
    """
    –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∏—Ä–∂–∞–º–∏ —á–µ—Ä–µ–∑ CCXT.
    –î–æ–±–∞–≤–ª—è–µ—Ç retry-–ª–æ–≥–∏–∫—É, rate limiting, –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫.
    """

    def __init__(
        self,
        exchange_name: str,
        api_key: str,
        api_secret: str,
        testnet: bool = False,
        rate_limit: bool = True
    ):
        self.exchange_name = exchange_name
        self.testnet = testnet

        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è CCXT exchange
        exchange_class = getattr(ccxt, exchange_name)

        options = {
            'apiKey': api_key,
            'secret': api_secret,
            'enableRateLimit': rate_limit,
            'timeout': 30000,
        }

        # Testnet –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        if testnet:
            if exchange_name == 'binance':
                options['urls'] = {
                    'api': {
                        'public': 'https://testnet.binance.vision/api',
                        'private': 'https://testnet.binance.vision/api',
                    }
                }
            elif exchange_name == 'bybit':
                options['urls'] = {
                    'api': 'https://api-testnet.bybit.com'
                }

        self.exchange = exchange_class(options)

        # –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        self._ticker_cache: Dict[str, Any] = {}
        self._ticker_cache_time: Dict[str, datetime] = {}
        self._cache_ttl = timedelta(seconds=5)

        logger.info(f"Initialized {exchange_name} client (testnet={testnet})")

    async def fetch_ticker(self, symbol: str, use_cache: bool = True) -> Dict:
        """–ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º"""
        now = datetime.now()

        if use_cache and symbol in self._ticker_cache:
            if now - self._ticker_cache_time[symbol] < self._cache_ttl:
                return self._ticker_cache[symbol]

        ticker = await self._retry_async(
            self.exchange.fetch_ticker,
            symbol
        )

        self._ticker_cache[symbol] = ticker
        self._ticker_cache_time[symbol] = now

        return ticker

    async def create_limit_order(
        self,
        symbol: str,
        side: str,
        amount: float,
        price: float,
        params: Optional[Dict] = None
    ) -> Dict:
        """–°–æ–∑–¥–∞—Ç—å –ª–∏–º–∏—Ç–Ω—ã–π –æ—Ä–¥–µ—Ä"""
        if params is None:
            params = {}

        logger.info(
            f"Creating limit order: {side} {amount} {symbol} @ {price}"
        )

        order = await self._retry_async(
            self.exchange.create_limit_order,
            symbol, side, amount, price, params
        )

        logger.info(f"Order created: {order['id']}")
        return order

    async def create_market_order(
        self,
        symbol: str,
        side: str,
        amount: float,
        params: Optional[Dict] = None
    ) -> Dict:
        """–°–æ–∑–¥–∞—Ç—å —Ä—ã–Ω–æ—á–Ω—ã–π –æ—Ä–¥–µ—Ä"""
        if params is None:
            params = {}

        logger.info(f"Creating market order: {side} {amount} {symbol}")

        order = await self._retry_async(
            self.exchange.create_market_order,
            symbol, side, amount, params
        )

        logger.info(f"Market order created: {order['id']}")
        return order

    async def cancel_order(self, order_id: str, symbol: str) -> Dict:
        """–û—Ç–º–µ–Ω–∏—Ç—å –æ—Ä–¥–µ—Ä"""
        logger.info(f"Canceling order {order_id} for {symbol}")

        result = await self._retry_async(
            self.exchange.cancel_order,
            order_id, symbol
        )

        logger.info(f"Order {order_id} canceled")
        return result

    async def fetch_open_orders(self, symbol: Optional[str] = None) -> List[Dict]:
        """–ü–æ–ª—É—á–∏—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã–µ –æ—Ä–¥–µ—Ä–∞"""
        return await self._retry_async(
            self.exchange.fetch_open_orders,
            symbol
        )

    async def fetch_balance(self) -> Dict:
        """–ü–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å"""
        return await self._retry_async(
            self.exchange.fetch_balance
        )

    async def fetch_my_trades(
        self,
        symbol: Optional[str] = None,
        since: Optional[int] = None,
        limit: Optional[int] = None
    ) -> List[Dict]:
        """–ü–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Å–¥–µ–ª–æ–∫"""
        return await self._retry_async(
            self.exchange.fetch_my_trades,
            symbol, since, limit
        )

    async def _retry_async(
        self,
        func,
        *args,
        max_retries: int = 3,
        retry_delay: float = 2.0,
        **kwargs
    ):
        """
        Retry –ª–æ–≥–∏–∫–∞ –¥–ª—è API –≤—ã–∑–æ–≤–æ–≤.
        –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ (network, rate limit).
        """
        last_exception = None

        for attempt in range(max_retries):
            try:
                # CCXT –º–µ—Ç–æ–¥—ã –º–æ–≥—É—Ç –±—ã—Ç—å sync –∏–ª–∏ async
                if asyncio.iscoroutinefunction(func):
                    result = await func(*args, **kwargs)
                else:
                    result = func(*args, **kwargs)
                return result

            except ccxt.NetworkError as e:
                last_exception = e
                logger.warning(
                    f"Network error (attempt {attempt + 1}/{max_retries}): {e}"
                )
                if attempt < max_retries - 1:
                    await asyncio.sleep(retry_delay * (attempt + 1))

            except ccxt.RateLimitExceeded as e:
                last_exception = e
                logger.warning(
                    f"Rate limit exceeded (attempt {attempt + 1}/{max_retries})"
                )
                if attempt < max_retries - 1:
                    await asyncio.sleep(retry_delay * (attempt + 1) * 2)

            except ccxt.ExchangeError as e:
                # –ù–µ —Ä–µ—Ç—Ä–∞–∏–º –æ—à–∏–±–∫–∏ –ª–æ–≥–∏–∫–∏ (insufficient balance, invalid order)
                logger.error(f"Exchange error: {e}")
                raise

            except Exception as e:
                logger.error(f"Unexpected error: {e}")
                raise

        # –í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –∏—Å—á–µ—Ä–ø–∞–Ω—ã
        logger.error(f"All retries failed. Last error: {last_exception}")
        raise last_exception

    def get_min_order_amount(self, symbol: str) -> Decimal:
        """–ü–æ–ª—É—á–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–±—ä–µ–º –æ—Ä–¥–µ—Ä–∞ –¥–ª—è —Å–∏–º–≤–æ–ª–∞"""
        market = self.exchange.market(symbol)
        return Decimal(str(market['limits']['amount']['min']))

    def get_price_precision(self, symbol: str) -> int:
        """–ü–æ–ª—É—á–∏—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å —Ü–µ–Ω—ã –¥–ª—è —Å–∏–º–≤–æ–ª–∞"""
        market = self.exchange.market(symbol)
        return market['precision']['price']

    def get_amount_precision(self, symbol: str) -> int:
        """–ü–æ–ª—É—á–∏—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –æ–±—ä–µ–º–∞ –¥–ª—è —Å–∏–º–≤–æ–ª–∞"""
        market = self.exchange.market(symbol)
        return market['precision']['amount']

    async def close(self):
        """–ó–∞–∫—Ä—ã—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è"""
        await self.exchange.close()
        logger.info(f"Closed {self.exchange_name} client")
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```python
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
client = ExchangeAPIClient(
    exchange_name='binance',
    api_key=api_key,
    api_secret=api_secret,
    testnet=True
)

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ü–µ–Ω—ã
ticker = await client.fetch_ticker('BTC/USDT')
current_price = ticker['last']

# –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ä–¥–µ—Ä–∞
order = await client.create_limit_order(
    symbol='BTC/USDT',
    side='buy',
    amount=0.001,
    price=40000.0,
    params={'postOnly': True}  # Maker-only order
)

# –ó–∞–∫—Ä—ã—Ç–∏–µ
await client.close()
```

---

### –ó–∞–¥–∞—á–∞ 1.3: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –º–æ–¥—É–ª—è DatabaseManager

**SQLAlchemy –º–æ–¥–µ–ª–∏ (src/database/models.py):**

```python
from sqlalchemy import (
    Column, Integer, String, Numeric, DateTime, Boolean,
    ForeignKey, Text, Index
)
from sqlalchemy.dialects.postgresql import JSONB
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.sql import func
from datetime import datetime

Base = declarative_base()


class Bot(Base):
    __tablename__ = 'bots'

    id = Column(Integer, primary_key=True)
    name = Column(String(100), nullable=False, unique=True)
    exchange = Column(String(50), nullable=False)
    symbol = Column(String(20), nullable=False)
    strategy_type = Column(String(20), nullable=False)
    config = Column(JSONB, nullable=False)
    state = Column(String(20), default='stopped')
    total_capital = Column(Numeric(20, 8), nullable=False)
    available_capital = Column(Numeric(20, 8), nullable=False)
    created_at = Column(DateTime, default=datetime.utcnow)
    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)


class ExchangeCredential(Base):
    __tablename__ = 'exchange_credentials'

    id = Column(Integer, primary_key=True)
    bot_id = Column(Integer, ForeignKey('bots.id', ondelete='CASCADE'))
    exchange = Column(String(50), nullable=False)
    api_key_encrypted = Column(Text, nullable=False)
    api_secret_encrypted = Column(Text, nullable=False)
    passphrase_encrypted = Column(Text)
    created_at = Column(DateTime, default=datetime.utcnow)


class Order(Base):
    __tablename__ = 'orders'

    id = Column(Integer, primary_key=True)
    bot_id = Column(Integer, ForeignKey('bots.id', ondelete='CASCADE'), nullable=False)
    exchange_order_id = Column(String(100))
    symbol = Column(String(20), nullable=False)
    type = Column(String(10), nullable=False)
    side = Column(String(10), nullable=False)
    price = Column(Numeric(20, 8))
    amount = Column(Numeric(20, 8), nullable=False)
    filled = Column(Numeric(20, 8), default=0)
    remaining = Column(Numeric(20, 8))
    status = Column(String(20), nullable=False)
    strategy_component = Column(String(20))
    grid_level = Column(Integer)
    dca_step = Column(Integer)
    created_at = Column(DateTime, default=datetime.utcnow)
    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)
    closed_at = Column(DateTime)

    __table_args__ = (
        Index('idx_orders_bot_status', 'bot_id', 'status'),
        Index('idx_orders_exchange_id', 'exchange_order_id'),
    )


class Trade(Base):
    __tablename__ = 'trades'

    id = Column(Integer, primary_key=True)
    bot_id = Column(Integer, ForeignKey('bots.id', ondelete='CASCADE'))
    order_id = Column(Integer, ForeignKey('orders.id'))
    exchange_trade_id = Column(String(100))
    symbol = Column(String(20), nullable=False)
    side = Column(String(10), nullable=False)
    price = Column(Numeric(20, 8), nullable=False)
    amount = Column(Numeric(20, 8), nullable=False)
    fee = Column(Numeric(20, 8))
    fee_currency = Column(String(10))
    realized_pnl = Column(Numeric(20, 8))
    timestamp = Column(DateTime, nullable=False)
    created_at = Column(DateTime, default=datetime.utcnow)

    __table_args__ = (
        Index('idx_trades_bot_timestamp', 'bot_id', 'timestamp'),
    )


class BotState(Base):
    __tablename__ = 'bot_states'

    id = Column(Integer, primary_key=True)
    bot_id = Column(Integer, ForeignKey('bots.id', ondelete='CASCADE'))
    state_data = Column(JSONB, nullable=False)
    timestamp = Column(DateTime, default=datetime.utcnow)

    __table_args__ = (
        Index('idx_bot_states_bot_timestamp', 'bot_id', 'timestamp'),
    )


class Log(Base):
    __tablename__ = 'logs'

    id = Column(Integer, primary_key=True)
    bot_id = Column(Integer, ForeignKey('bots.id', ondelete='CASCADE'))
    level = Column(String(10), nullable=False)
    message = Column(Text, nullable=False)
    context = Column(JSONB)
    timestamp = Column(DateTime, default=datetime.utcnow)

    __table_args__ = (
        Index('idx_logs_bot_level_timestamp', 'bot_id', 'level', 'timestamp'),
    )


class PerformanceMetric(Base):
    __tablename__ = 'performance_metrics'

    id = Column(Integer, primary_key=True)
    bot_id = Column(Integer, ForeignKey('bots.id', ondelete='CASCADE'))
    total_trades = Column(Integer, default=0)
    winning_trades = Column(Integer, default=0)
    losing_trades = Column(Integer, default=0)
    total_pnl = Column(Numeric(20, 8), default=0)
    total_fees = Column(Numeric(20, 8), default=0)
    max_drawdown = Column(Numeric(10, 4), default=0)
    current_drawdown = Column(Numeric(10, 4), default=0)
    sharpe_ratio = Column(Numeric(10, 4))
    updated_at = Column(DateTime, default=datetime.utcnow, onupdate=datetime.utcnow)
```

**Database Manager (src/database/manager.py):**

```python
from sqlalchemy.ext.asyncio import create_async_engine, AsyncSession
from sqlalchemy.orm import sessionmaker
from sqlalchemy import select, update, delete
from typing import Optional, List, Dict, Any
import logging
from .models import Base, Bot, Order, Trade, BotState, Log, PerformanceMetric

logger = logging.getLogger(__name__)


class DatabaseManager:
    """–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö"""

    def __init__(self, database_url: str):
        self.database_url = database_url

        # –°–æ–∑–¥–∞–Ω–∏–µ async engine
        self.engine = create_async_engine(
            database_url,
            echo=False,  # True –¥–ª—è debug SQL –∑–∞–ø—Ä–æ—Å–æ–≤
            pool_size=10,
            max_overflow=20
        )

        # Session factory
        self.async_session = sessionmaker(
            self.engine,
            class_=AsyncSession,
            expire_on_commit=False
        )

        logger.info("DatabaseManager initialized")

    async def init_db(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü"""
        async with self.engine.begin() as conn:
            await conn.run_sync(Base.metadata.create_all)
        logger.info("Database tables created")

    async def create_bot(self, bot_data: Dict[str, Any]) -> Bot:
        """–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞"""
        async with self.async_session() as session:
            bot = Bot(**bot_data)
            session.add(bot)
            await session.commit()
            await session.refresh(bot)
            logger.info(f"Created bot: {bot.name} (id={bot.id})")
            return bot

    async def get_bot(self, bot_id: int) -> Optional[Bot]:
        """–ü–æ–ª—É—á–∏—Ç—å –±–æ—Ç–∞ –ø–æ ID"""
        async with self.async_session() as session:
            result = await session.execute(
                select(Bot).where(Bot.id == bot_id)
            )
            return result.scalar_one_or_none()

    async def update_bot_state(self, bot_id: int, new_state: str):
        """–û–±–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–æ—Ç–∞"""
        async with self.async_session() as session:
            await session.execute(
                update(Bot)
                .where(Bot.id == bot_id)
                .values(state=new_state)
            )
            await session.commit()
            logger.info(f"Bot {bot_id} state updated to {new_state}")

    async def create_order(self, order_data: Dict[str, Any]) -> Order:
        """–°–æ–∑–¥–∞—Ç—å –æ—Ä–¥–µ—Ä"""
        async with self.async_session() as session:
            order = Order(**order_data)
            session.add(order)
            await session.commit()
            await session.refresh(order)
            return order

    async def get_open_orders(self, bot_id: int) -> List[Order]:
        """–ü–æ–ª—É—á–∏—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã–µ –æ—Ä–¥–µ—Ä–∞ –±–æ—Ç–∞"""
        async with self.async_session() as session:
            result = await session.execute(
                select(Order)
                .where(Order.bot_id == bot_id, Order.status == 'open')
            )
            return result.scalars().all()

    async def update_order_status(
        self,
        order_id: int,
        status: str,
        filled: Optional[float] = None
    ):
        """–û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –æ—Ä–¥–µ—Ä–∞"""
        async with self.async_session() as session:
            values = {'status': status}
            if filled is not None:
                values['filled'] = filled

            await session.execute(
                update(Order)
                .where(Order.id == order_id)
                .values(**values)
            )
            await session.commit()

    async def create_trade(self, trade_data: Dict[str, Any]) -> Trade:
        """–°–æ–∑–¥–∞—Ç—å —Å–¥–µ–ª–∫—É"""
        async with self.async_session() as session:
            trade = Trade(**trade_data)
            session.add(trade)
            await session.commit()
            await session.refresh(trade)
            return trade

    async def get_bot_trades(
        self,
        bot_id: int,
        limit: int = 100
    ) -> List[Trade]:
        """–ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–¥–µ–ª–∫–∏ –±–æ—Ç–∞"""
        async with self.async_session() as session:
            result = await session.execute(
                select(Trade)
                .where(Trade.bot_id == bot_id)
                .order_by(Trade.timestamp.desc())
                .limit(limit)
            )
            return result.scalars().all()

    async def save_bot_state(self, bot_id: int, state_data: Dict[str, Any]):
        """–°–æ—Ö—Ä–∞–Ω–∏—Ç—å snapshot —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–æ—Ç–∞"""
        async with self.async_session() as session:
            bot_state = BotState(bot_id=bot_id, state_data=state_data)
            session.add(bot_state)
            await session.commit()

    async def create_log(
        self,
        bot_id: int,
        level: str,
        message: str,
        context: Optional[Dict] = None
    ):
        """–°–æ–∑–¥–∞—Ç—å –ª–æ–≥-–∑–∞–ø–∏—Å—å"""
        async with self.async_session() as session:
            log = Log(
                bot_id=bot_id,
                level=level,
                message=message,
                context=context
            )
            session.add(log)
            await session.commit()

    async def close(self):
        """–ó–∞–∫—Ä—ã—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è"""
        await self.engine.dispose()
        logger.info("DatabaseManager closed")
```

---

### –ó–∞–¥–∞—á–∞ 1.4: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª—è ConfigManager

```python
# src/core/config.py

import yaml
from pathlib import Path
from typing import Dict, Any, Optional
from pydantic import BaseModel, Field, validator
from decimal import Decimal
import logging

logger = logging.getLogger(__name__)


class GridConfig(BaseModel):
    """Grid —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è"""
    enabled: bool = True
    type: str = "static"  # static –∏–ª–∏ dynamic
    upper_price: Decimal
    lower_price: Decimal
    grid_levels: int = Field(ge=2, le=100)
    profit_per_level_percent: Decimal = Decimal("0.5")
    order_type: str = "limit"
    post_only: bool = True
    reinvest_profit: bool = True
    reinvest_threshold_usdt: Decimal = Decimal("50.0")

    @validator('type')
    def validate_type(cls, v):
        if v not in ['static', 'dynamic']:
            raise ValueError("type must be 'static' or 'dynamic'")
        return v

    @validator('upper_price', 'lower_price')
    def validate_prices(cls, v):
        if v <= 0:
            raise ValueError("Prices must be positive")
        return v


class DCAConfig(BaseModel):
    """DCA —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è"""
    enabled: bool = True
    trigger_type: str = "price_drop"
    activation_drop_percent: Decimal = Decimal("5.0")
    step_percent: Decimal = Decimal("3.0")
    order_amount_usdt: Decimal = Decimal("50.0")
    order_amount_percent: Optional[Decimal] = Decimal("10.0")
    max_dca_orders: int = Field(ge=1, le=20, default=5)
    target_profit_percent: Decimal = Decimal("5.0")
    cooldown_seconds: int = 300

    @validator('trigger_type')
    def validate_trigger(cls, v):
        if v not in ['price_drop', 'manual', 'schedule']:
            raise ValueError("Invalid trigger_type")
        return v


class RiskConfig(BaseModel):
    """Risk management –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è"""
    max_drawdown_percent: Decimal = Decimal("15.0")
    auto_stop_on_max_drawdown: bool = True
    take_profit_percent: Optional[Decimal] = Decimal("20.0")
    max_open_orders: int = 50
    min_order_amount_usdt: Decimal = Decimal("10.0")


class CapitalConfig(BaseModel):
    """–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞–ø–∏—Ç–∞–ª–∞"""
    total_capital_usdt: Decimal = Field(gt=0)
    grid_allocation_percent: int = Field(ge=0, le=100, default=60)
    dca_allocation_percent: int = Field(ge=0, le=100, default=40)

    @validator('dca_allocation_percent')
    def validate_allocation(cls, v, values):
        if 'grid_allocation_percent' in values:
            if v + values['grid_allocation_percent'] != 100:
                raise ValueError("Total allocation must equal 100%")
        return v


class BotConfig(BaseModel):
    """–ü–æ–ª–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–æ—Ç–∞"""
    name: str
    exchange: str
    symbol: str
    strategy_type: str
    capital: CapitalConfig
    grid: GridConfig
    dca: DCAConfig
    risk: RiskConfig

    @validator('strategy_type')
    def validate_strategy(cls, v):
        if v not in ['grid', 'dca', 'hybrid']:
            raise ValueError("Invalid strategy_type")
        return v


class ConfigManager:
    """–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –±–æ—Ç–∞"""

    def __init__(self, config_path: str):
        self.config_path = Path(config_path)
        self.config: Optional[BotConfig] = None

    def load_config(self) -> BotConfig:
        """–ó–∞–≥—Ä—É–∑–∏—Ç—å –∏ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é"""
        if not self.config_path.exists():
            raise FileNotFoundError(f"Config file not found: {self.config_path}")

        with open(self.config_path, 'r') as f:
            raw_config = yaml.safe_load(f)

        # –í–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ Pydantic
        self.config = BotConfig(**raw_config['bot'])

        logger.info(f"Configuration loaded from {self.config_path}")
        return self.config

    def get_config(self) -> BotConfig:
        """–ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é"""
        if self.config is None:
            return self.load_config()
        return self.config

    def reload_config(self) -> BotConfig:
        """–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é"""
        logger.info("Reloading configuration...")
        return self.load_config()

    def validate_config_file(self, config_path: str) -> bool:
        """–í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª –±–µ–∑ –∑–∞–≥—Ä—É–∑–∫–∏"""
        try:
            with open(config_path, 'r') as f:
                raw_config = yaml.safe_load(f)
            BotConfig(**raw_config['bot'])
            return True
        except Exception as e:
            logger.error(f"Config validation failed: {e}")
            return False
```

---

### –ó–∞–¥–∞—á–∞ 1.5: –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

```python
# src/utils/logger.py

import logging
import logging.handlers
from pathlib import Path
from datetime import datetime
import sys


def setup_logger(
    name: str = "dca_grid_bot",
    log_level: str = "INFO",
    log_file: str = "./logs/bot.log",
    log_to_console: bool = True,
    log_to_file: bool = True,
    max_bytes: int = 10 * 1024 * 1024,  # 10 MB
    backup_count: int = 5
) -> logging.Logger:
    """
    –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –±–æ—Ç–∞.

    Args:
        name: –ò–º—è –ª–æ–≥–≥–µ—Ä–∞
        log_level: –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (DEBUG, INFO, WARNING, ERROR, CRITICAL)
        log_file: –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É –ª–æ–≥–æ–≤
        log_to_console: –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤ –∫–æ–Ω—Å–æ–ª—å
        log_to_file: –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤ —Ñ–∞–π–ª
        max_bytes: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –ª–æ–≥–æ–≤ –ø–µ—Ä–µ–¥ —Ä–æ—Ç–∞—Ü–∏–µ–π
        backup_count: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ backup —Ñ–∞–π–ª–æ–≤

    Returns:
        –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π logger
    """

    # –°–æ–∑–¥–∞–Ω–∏–µ –ª–æ–≥–≥–µ—Ä–∞
    logger = logging.getLogger(name)
    logger.setLevel(getattr(logging, log_level.upper()))

    # –û—á–∏—Å—Ç–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö handlers
    logger.handlers.clear()

    # –§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤
    formatter = logging.Formatter(
        fmt='%(asctime)s | %(name)s | %(levelname)-8s | %(message)s',
        datefmt='%Y-%m-%d %H:%M:%S'
    )

    # Console handler
    if log_to_console:
        console_handler = logging.StreamHandler(sys.stdout)
        console_handler.setLevel(logging.DEBUG)
        console_handler.setFormatter(formatter)
        logger.addHandler(console_handler)

    # File handler —Å —Ä–æ—Ç–∞—Ü–∏–µ–π
    if log_to_file:
        # –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –ª–æ–≥–æ–≤
        log_path = Path(log_file)
        log_path.parent.mkdir(parents=True, exist_ok=True)

        file_handler = logging.handlers.RotatingFileHandler(
            filename=log_file,
            maxBytes=max_bytes,
            backupCount=backup_count,
            encoding='utf-8'
        )
        file_handler.setLevel(logging.DEBUG)
        file_handler.setFormatter(formatter)
        logger.addHandler(file_handler)

    logger.info("=" * 80)
    logger.info(f"Logger initialized: {name}")
    logger.info(f"Log level: {log_level}")
    logger.info(f"Log to console: {log_to_console}")
    logger.info(f"Log to file: {log_to_file} ({log_file})")
    logger.info("=" * 80)

    return logger


# –ì–ª–æ–±–∞–ª—å–Ω—ã–π –ª–æ–≥–≥–µ—Ä
main_logger = setup_logger()
```

---

## 4. –≠—Ç–∞–ø 2: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π

### –ó–∞–¥–∞—á–∞ 2.1: –ú–æ–¥—É–ª—å —Å–µ—Ç–æ—á–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ (GridEngine)

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
1. –†–∞—Å—á–µ—Ç —É—Ä–æ–≤–Ω–µ–π —Ü–µ–Ω –¥–ª—è —Å–µ—Ç–∫–∏
2. –†–∞–∑–º–µ—â–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω–æ–π —Å–µ—Ç–∫–∏ –æ—Ä–¥–µ—Ä–æ–≤
3. –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Ä–¥–µ—Ä–æ–≤
4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ (—Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ–≥–æ –æ—Ä–¥–µ—Ä–∞)

**–ü—Å–µ–≤–¥–æ–∫–æ–¥ –ª–æ–≥–∏–∫–∏:**

```python
# src/strategies/grid_engine.py

from typing import List, Dict, Optional, Tuple
from decimal import Decimal
import logging
import asyncio

logger = logging.getLogger(__name__)


class GridEngine:
    """
    –î–≤–∏–∂–æ–∫ —Å–µ—Ç–æ—á–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏.
    –£–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ–º –∏ –ø–µ—Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–æ–π —Å–µ—Ç–æ—á–Ω—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤.
    """

    def __init__(
        self,
        exchange_client,
        db_manager,
        bot_id: int,
        config: Dict
    ):
        self.exchange_client = exchange_client
        self.db_manager = db_manager
        self.bot_id = bot_id
        self.config = config

        self.symbol = config['symbol']
        self.grid_type = config['grid']['type']
        self.upper_price = Decimal(str(config['grid']['upper_price']))
        self.lower_price = Decimal(str(config['grid']['lower_price']))
        self.grid_levels = config['grid']['grid_levels']
        self.grid_allocation = Decimal(str(config['capital']['total_capital_usdt'])) * \
                               Decimal(str(config['capital']['grid_allocation_percent'])) / 100

        self.grid_orders: Dict[int, str] = {}  # level -> order_id
        self.is_running = False

        logger.info(f"GridEngine initialized for {self.symbol}")
        logger.info(f"Grid range: {self.lower_price} - {self.upper_price}")
        logger.info(f"Levels: {self.grid_levels}, Allocation: {self.grid_allocation} USDT")

    def calculate_grid_levels(self) -> List[Decimal]:
        """
        –†–∞—Å—á–µ—Ç —Ü–µ–Ω —É—Ä–æ–≤–Ω–µ–π —Å–µ—Ç–∫–∏.

        –î–ª—è static grid: —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ.
        –î–ª—è dynamic grid: –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—è (–±–æ–ª—å—à–µ –æ—Ä–¥–µ—Ä–æ–≤ –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ).
        """
        levels = []

        if self.grid_type == 'static':
            # –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
            step = (self.upper_price - self.lower_price) / (self.grid_levels - 1)
            for i in range(self.grid_levels):
                price = self.lower_price + step * i
                levels.append(price)

        elif self.grid_type == 'dynamic':
            # –ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—è (–ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–∞—è —à–∫–∞–ª–∞)
            import math
            log_lower = math.log(float(self.lower_price))
            log_upper = math.log(float(self.upper_price))
            log_step = (log_upper - log_lower) / (self.grid_levels - 1)

            for i in range(self.grid_levels):
                log_price = log_lower + log_step * i
                price = Decimal(str(math.exp(log_price)))
                levels.append(price)

        logger.info(f"Calculated {len(levels)} grid levels")
        logger.debug(f"Grid levels: {[float(p) for p in levels]}")

        return levels

    def calculate_order_amounts(
        self,
        grid_levels: List[Decimal]
    ) -> List[Decimal]:
        """
        –†–∞—Å—á–µ—Ç –æ–±—ä–µ–º–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–≤–Ω—è.

        –ü—Ä–æ—Å—Ç–æ–π –ø–æ–¥—Ö–æ–¥: —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞–ø–∏—Ç–∞–ª–∞.
        –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π: –±–æ–ª—å—à–µ –∫–∞–ø–∏—Ç–∞–ª–∞ –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞.
        """
        # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ buy –æ—Ä–¥–µ—Ä–æ–≤ (–Ω–∏–∂–µ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã) –∏ sell –æ—Ä–¥–µ—Ä–æ–≤ (–≤—ã—à–µ)
        # –î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã: 50/50 split
        total_buy_levels = self.grid_levels // 2

        # –ö–∞–ø–∏—Ç–∞–ª –Ω–∞ –æ–¥–∏–Ω buy —É—Ä–æ–≤–µ–Ω—å
        capital_per_level = self.grid_allocation / total_buy_levels

        amounts = []
        for level_price in grid_levels:
            # –û–±—ä–µ–º –≤ –±–∞–∑–æ–≤–æ–π –≤–∞–ª—é—Ç–µ (BTC –¥–ª—è BTC/USDT)
            amount = capital_per_level / level_price
            amounts.append(amount)

        return amounts

    async def initialize_grid(self, current_price: Decimal):
        """
        –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω–æ–π —Å–µ—Ç–∫–∏ –æ—Ä–¥–µ—Ä–æ–≤.

        –õ–æ–≥–∏–∫–∞:
        1. –£—Ä–æ–≤–Ω–∏ –Ω–∏–∂–µ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã -> BUY –æ—Ä–¥–µ—Ä–∞
        2. –£—Ä–æ–≤–Ω–∏ –≤—ã—à–µ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã -> SELL –æ—Ä–¥–µ—Ä–∞ (—Ç—Ä–µ–±—É–µ—Ç –Ω–∞–ª–∏—á–∏–µ –±–∞–∑–æ–≤–æ–π –≤–∞–ª—é—Ç—ã)
        """
        grid_levels = self.calculate_grid_levels()
        amounts = self.calculate_order_amounts(grid_levels)

        logger.info(f"Initializing grid... Current price: {current_price}")

        for i, (price, amount) in enumerate(zip(grid_levels, amounts)):
            # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —É—Ä–æ–≤–Ω–∏ —Å–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–∏–µ –∫ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω–µ (¬±0.1%)
            price_diff_percent = abs(price - current_price) / current_price * 100
            if price_diff_percent < 0.1:
                logger.debug(f"Skipping level {i} at {price} (too close to current price)")
                continue

            # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω—ã
            side = 'buy' if price < current_price else 'sell'

            # –î–ª—è SELL –æ—Ä–¥–µ—Ä–æ–≤ –Ω—É–∂–Ω–æ –∏–º–µ—Ç—å –±–∞–∑–æ–≤—É—é –≤–∞–ª—é—Ç—É
            # –í –Ω–∞—á–∞–ª–µ –º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å sell –æ—Ä–¥–µ—Ä–∞ –∏–ª–∏ –∫—É–ø–∏—Ç—å –±–∞–∑—É –∑–∞—Ä–∞–Ω–µ–µ
            if side == 'sell':
                # TODO: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –±–∞–∑–æ–≤–æ–π –≤–∞–ª—é—Ç—ã
                logger.debug(f"Skipping sell level {i} at {price} (need base currency)")
                continue

            try:
                # –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ä–¥–µ—Ä–∞ –Ω–∞ –±–∏—Ä–∂–µ
                order = await self.exchange_client.create_limit_order(
                    symbol=self.symbol,
                    side=side,
                    amount=float(amount),
                    price=float(price),
                    params={'postOnly': True}  # Maker-only
                )

                # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
                await self.db_manager.create_order({
                    'bot_id': self.bot_id,
                    'exchange_order_id': order['id'],
                    'symbol': self.symbol,
                    'type': 'limit',
                    'side': side,
                    'price': price,
                    'amount': amount,
                    'status': 'open',
                    'strategy_component': 'grid',
                    'grid_level': i
                })

                self.grid_orders[i] = order['id']

                logger.info(f"Grid order placed: Level {i}, {side} {amount} @ {price}")

                # –ü–∞—É–∑–∞ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è rate limit
                await asyncio.sleep(0.2)

            except Exception as e:
                logger.error(f"Failed to create grid order at level {i}: {e}")

        logger.info(f"Grid initialization complete. {len(self.grid_orders)} orders placed.")
        self.is_running = True

    async def monitor_orders(self):
        """
        –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Ä–¥–µ—Ä–æ–≤ –∏ –ø–µ—Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞.

        –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª:
        1. –ü–æ–ª—É—á–∏—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã–µ –æ—Ä–¥–µ—Ä–∞
        2. –°—Ä–∞–≤–Ω–∏—Ç—å —Å –ª–æ–∫–∞–ª—å–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
        3. –î–ª—è –∏—Å–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤ -> —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã–π
        """
        logger.info("Starting order monitoring...")

        while self.is_running:
            try:
                # –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤ —Å –±–∏—Ä–∂–∏
                open_orders = await self.exchange_client.fetch_open_orders(self.symbol)
                open_order_ids = {order['id'] for order in open_orders}

                # –ü–æ–∏—Å–∫ –∏—Å–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤ (–±—ã–ª–∏ –≤ grid_orders, –Ω–æ –Ω–µ—Ç –≤ open_orders)
                for level, order_id in list(self.grid_orders.items()):
                    if order_id not in open_order_ids:
                        logger.info(f"Order {order_id} (level {level}) has been filled!")

                        # –ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–Ω–æ–≥–æ –æ—Ä–¥–µ—Ä–∞
                        # (–Ω—É–∂–Ω–æ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ü–µ–Ω—ã –∏ —Å—Ç–æ—Ä–æ–Ω—ã)
                        filled_order = await self._get_order_details(order_id)

                        if filled_order:
                            await self._rebalance_after_fill(filled_order, level)

                        # –£–¥–∞–ª–∏—Ç—å –∏–∑ tracking
                        del self.grid_orders[level]

                # –ü–∞—É–∑–∞ –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–µ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π
                await asyncio.sleep(10)  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥

            except Exception as e:
                logger.error(f"Error in order monitoring: {e}")
                await asyncio.sleep(30)

    async def _get_order_details(self, order_id: str) -> Optional[Dict]:
        """–ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –æ—Ä–¥–µ—Ä–∞ –∏–∑ –ë–î"""
        # TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å –∫ –ë–î
        pass

    async def _rebalance_after_fill(self, filled_order: Dict, level: int):
        """
        –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ–≥–æ –æ—Ä–¥–µ—Ä–∞ –ø–æ—Å–ª–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è.

        –õ–æ–≥–∏–∫–∞:
        - –ï—Å–ª–∏ –±—ã–ª –∏—Å–ø–æ–ª–Ω–µ–Ω BUY –æ—Ä–¥–µ—Ä -> —Å–æ–∑–¥–∞—Ç—å SELL –æ—Ä–¥–µ—Ä –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –≤—ã—à–µ
        - –ï—Å–ª–∏ –±—ã–ª –∏—Å–ø–æ–ª–Ω–µ–Ω SELL –æ—Ä–¥–µ—Ä -> —Å–æ–∑–¥–∞—Ç—å BUY –æ—Ä–¥–µ—Ä –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –Ω–∏–∂–µ
        """
        side = filled_order['side']
        price = Decimal(str(filled_order['price']))
        amount = Decimal(str(filled_order['amount']))

        # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–æ–≤–æ–≥–æ –æ—Ä–¥–µ—Ä–∞
        if side == 'buy':
            # –ü–æ—Å–ª–µ –ø–æ–∫—É–ø–∫–∏ -> –ø—Ä–æ–¥–∞—Ç—å –≤—ã—à–µ
            new_side = 'sell'
            new_price = price * (1 + self.config['grid']['profit_per_level_percent'] / 100)
            new_amount = amount  # –ü—Ä–æ–¥–∞–µ–º —Ç–æ –∂–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
        else:
            # –ü–æ—Å–ª–µ –ø—Ä–æ–¥–∞–∂–∏ -> –∫—É–ø–∏—Ç—å –Ω–∏–∂–µ
            new_side = 'buy'
            new_price = price * (1 - self.config['grid']['profit_per_level_percent'] / 100)
            # –î–ª—è –ø–æ–∫—É–ø–∫–∏ –Ω—É–∂–Ω–æ —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å USDT amount
            new_amount = amount  # –£–ø—Ä–æ—â–µ–Ω–Ω–æ, –Ω—É–∂–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞

        try:
            # –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ä–¥–µ—Ä–∞
            order = await self.exchange_client.create_limit_order(
                symbol=self.symbol,
                side=new_side,
                amount=float(new_amount),
                price=float(new_price),
                params={'postOnly': True}
            )

            # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
            await self.db_manager.create_order({
                'bot_id': self.bot_id,
                'exchange_order_id': order['id'],
                'symbol': self.symbol,
                'type': 'limit',
                'side': new_side,
                'price': new_price,
                'amount': new_amount,
                'status': 'open',
                'strategy_component': 'grid',
                'grid_level': level
            })

            # –û–±–Ω–æ–≤–∏—Ç—å tracking
            self.grid_orders[level] = order['id']

            logger.info(f"Rebalance order placed: {new_side} {new_amount} @ {new_price}")

        except Exception as e:
            logger.error(f"Failed to create rebalance order: {e}")

    async def stop(self):
        """–û—Å—Ç–∞–Ω–æ–≤–∫–∞ Grid Engine"""
        logger.info("Stopping GridEngine...")
        self.is_running = False

        # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –æ—Ç–º–µ–Ω–∏—Ç—å –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –æ—Ä–¥–µ—Ä–∞
        # (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤—ã—Ö–æ–¥–∞)

    async def cancel_all_orders(self):
        """–û—Ç–º–µ–Ω–∞ –≤—Å–µ—Ö Grid –æ—Ä–¥–µ—Ä–æ–≤"""
        logger.info("Canceling all grid orders...")

        for level, order_id in self.grid_orders.items():
            try:
                await self.exchange_client.cancel_order(order_id, self.symbol)
                logger.info(f"Canceled order {order_id} (level {level})")
            except Exception as e:
                logger.error(f"Failed to cancel order {order_id}: {e}")

        self.grid_orders.clear()
```

---

### –ó–∞–¥–∞—á–∞ 2.2: –ú–æ–¥—É–ª—å DCA (DCAEngine)

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
1. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ DCA
2. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ DCA-–ø–æ–∫—É–ø–æ–∫ –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–π –ª–æ–≥–∏–∫–µ
3. –†–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–π —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞
4. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤—ã–º–∏ —É—Ä–æ–≤–Ω—è–º–∏ –ø—Ä–æ–¥–∞–∂–∏

**–ü—Å–µ–≤–¥–æ–∫–æ–¥:**

```python
# src/strategies/dca_engine.py

from typing import Optional, List
from decimal import Decimal
import logging
import asyncio
from datetime import datetime, timedelta

logger = logging.getLogger(__name__)


class DCAEngine:
    """
    –î–≤–∏–∂–æ–∫ Dollar-Cost Averaging (—É—Å—Ä–µ–¥–Ω–µ–Ω–∏—è).
    """

    def __init__(
        self,
        exchange_client,
        db_manager,
        bot_id: int,
        config: Dict
    ):
        self.exchange_client = exchange_client
        self.db_manager = db_manager
        self.bot_id = bot_id
        self.config = config

        self.symbol = config['symbol']
        self.dca_allocation = Decimal(str(config['capital']['total_capital_usdt'])) * \
                              Decimal(str(config['capital']['dca_allocation_percent'])) / 100

        self.activation_drop_percent = Decimal(str(config['dca']['activation_drop_percent']))
        self.step_percent = Decimal(str(config['dca']['step_percent']))
        self.order_amount_usdt = Decimal(str(config['dca']['order_amount_usdt']))
        self.max_dca_orders = config['dca']['max_dca_orders']
        self.target_profit_percent = Decimal(str(config['dca']['target_profit_percent']))
        self.cooldown_seconds = config['dca']['cooldown_seconds']

        # –°–æ—Å—Ç–æ—è–Ω–∏–µ DCA
        self.is_active = False
        self.dca_orders_count = 0
        self.last_dca_price: Optional[Decimal] = None
        self.average_entry_price: Optional[Decimal] = None
        self.total_dca_amount: Decimal = Decimal('0')
        self.last_dca_time: Optional[datetime] = None

        self.is_running = False

        logger.info(f"DCAEngine initialized for {self.symbol}")
        logger.info(f"DCA allocation: {self.dca_allocation} USDT")
        logger.info(f"Max DCA orders: {self.max_dca_orders}")

    def should_activate_dca(
        self,
        current_price: Decimal,
        grid_lower_boundary: Decimal
    ) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç—Ä–∏–≥–≥–µ—Ä–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ DCA.

        –ê–∫—Ç–∏–≤–∞—Ü–∏—è: —Ü–µ–Ω–∞ –ø–∞–¥–∞–µ—Ç –Ω–∏–∂–µ –Ω–∏–∂–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã Grid –Ω–∞ X%
        """
        activation_price = grid_lower_boundary * (1 - self.activation_drop_percent / 100)

        if current_price <= activation_price and not self.is_active:
            logger.info(
                f"DCA activated! Current price {current_price} <= "
                f"activation price {activation_price}"
            )
            return True

        return False

    def should_place_dca_order(self, current_price: Decimal) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è —Å–ª–µ–¥—É—é—â–µ–≥–æ DCA –æ—Ä–¥–µ—Ä–∞.

        –£—Å–ª–æ–≤–∏—è:
        1. DCA –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω
        2. –ù–µ –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –æ—Ä–¥–µ—Ä–æ–≤
        3. –¶–µ–Ω–∞ —É–ø–∞–ª–∞ –Ω–∞ step_percent –æ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø–æ–∫—É–ø–∫–∏
        4. –ü—Ä–æ—à–µ–ª cooldown –ø–µ—Ä–∏–æ–¥
        """
        if not self.is_active:
            return False

        if self.dca_orders_count >= self.max_dca_orders:
            logger.warning(f"Max DCA orders ({self.max_dca_orders}) reached")
            return False

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ cooldown
        if self.last_dca_time:
            cooldown_until = self.last_dca_time + timedelta(seconds=self.cooldown_seconds)
            if datetime.now() < cooldown_until:
                logger.debug("DCA cooldown period not elapsed")
                return False

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞–¥–µ–Ω–∏—è —Ü–µ–Ω—ã
        if self.last_dca_price:
            next_dca_price = self.last_dca_price * (1 - self.step_percent / 100)
            if current_price > next_dca_price:
                logger.debug(
                    f"Price {current_price} not yet reached next DCA level {next_dca_price}"
                )
                return False

        return True

    async def execute_dca_order(self, current_price: Decimal):
        """
        –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ DCA –ø–æ–∫—É–ø–∫–∏.
        """
        try:
            # –†–∞—Å—á–µ—Ç –æ–±—ä–µ–º–∞
            amount = self.order_amount_usdt / current_price

            logger.info(
                f"Executing DCA order #{self.dca_orders_count + 1}: "
                f"Buy {amount} {self.symbol} @ {current_price}"
            )

            # –°–æ–∑–¥–∞–Ω–∏–µ market –∏–ª–∏ limit –æ—Ä–¥–µ—Ä–∞
            if self.config['dca'].get('use_market_order', False):
                order = await self.exchange_client.create_market_order(
                    symbol=self.symbol,
                    side='buy',
                    amount=float(amount)
                )
            else:
                order = await self.exchange_client.create_limit_order(
                    symbol=self.symbol,
                    side='buy',
                    amount=float(amount),
                    price=float(current_price)
                )

            # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
            self.dca_orders_count += 1
            self.last_dca_price = current_price
            self.last_dca_time = datetime.now()

            # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–π —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞
            self._update_average_entry_price(current_price, amount)

            # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
            await self.db_manager.create_order({
                'bot_id': self.bot_id,
                'exchange_order_id': order['id'],
                'symbol': self.symbol,
                'type': order['type'],
                'side': 'buy',
                'price': current_price,
                'amount': amount,
                'status': 'open' if order['status'] == 'open' else 'closed',
                'strategy_component': 'dca',
                'dca_step': self.dca_orders_count
            })

            logger.info(f"DCA order executed successfully. Average entry: {self.average_entry_price}")

            # TODO: –°–æ–∑–¥–∞—Ç—å TP –æ—Ä–¥–µ—Ä
            await self._create_take_profit_order()

        except Exception as e:
            logger.error(f"Failed to execute DCA order: {e}")

    def _update_average_entry_price(self, price: Decimal, amount: Decimal):
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–π —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞"""
        if self.average_entry_price is None:
            self.average_entry_price = price
            self.total_dca_amount = amount
        else:
            # Weighted average
            total_cost = (self.average_entry_price * self.total_dca_amount) + (price * amount)
            self.total_dca_amount += amount
            self.average_entry_price = total_cost / self.total_dca_amount

    async def _create_take_profit_order(self):
        """
        –°–æ–∑–¥–∞–Ω–∏–µ take-profit –æ—Ä–¥–µ—Ä–∞ –ø–æ—Å–ª–µ DCA.

        –¶–µ–ª—å: –ø—Ä–æ–¥–∞—Ç—å –≤—Å—é –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—É—é –ø–æ–∑–∏—Ü–∏—é —Å –ø—Ä–∏–±—ã–ª—å—é.
        """
        if not self.average_entry_price or self.total_dca_amount == 0:
            return

        tp_price = self.average_entry_price * (1 + self.target_profit_percent / 100)

        try:
            order = await self.exchange_client.create_limit_order(
                symbol=self.symbol,
                side='sell',
                amount=float(self.total_dca_amount),
                price=float(tp_price),
                params={'postOnly': True}
            )

            logger.info(
                f"Take-profit order placed: Sell {self.total_dca_amount} @ {tp_price} "
                f"(avg entry: {self.average_entry_price})"
            )

            await self.db_manager.create_order({
                'bot_id': self.bot_id,
                'exchange_order_id': order['id'],
                'symbol': self.symbol,
                'type': 'limit',
                'side': 'sell',
                'price': tp_price,
                'amount': self.total_dca_amount,
                'status': 'open',
                'strategy_component': 'dca',
                'dca_step': -1  # -1 –æ–∑–Ω–∞—á–∞–µ—Ç TP –æ—Ä–¥–µ—Ä
            })

        except Exception as e:
            logger.error(f"Failed to create take-profit order: {e}")

    async def monitor_price(self, grid_lower_boundary: Decimal):
        """
        –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ü–µ–Ω—ã –¥–ª—è —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ DCA.
        """
        logger.info("Starting DCA price monitoring...")
        self.is_running = True

        while self.is_running:
            try:
                # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã
                ticker = await self.exchange_client.fetch_ticker(self.symbol)
                current_price = Decimal(str(ticker['last']))

                # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ DCA
                if not self.is_active:
                    if self.should_activate_dca(current_price, grid_lower_boundary):
                        self.is_active = True
                        self.last_dca_price = current_price

                # –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –¥–ª—è DCA –æ—Ä–¥–µ—Ä–∞
                if self.is_active:
                    if self.should_place_dca_order(current_price):
                        await self.execute_dca_order(current_price)

                # –ü–∞—É–∑–∞
                await asyncio.sleep(30)  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥

            except Exception as e:
                logger.error(f"Error in DCA price monitoring: {e}")
                await asyncio.sleep(60)

    async def stop(self):
        """–û—Å—Ç–∞–Ω–æ–≤–∫–∞ DCA Engine"""
        logger.info("Stopping DCAEngine...")
        self.is_running = False

    def get_state(self) -> Dict:
        """–ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ DCA"""
        return {
            'is_active': self.is_active,
            'dca_orders_count': self.dca_orders_count,
            'average_entry_price': float(self.average_entry_price) if self.average_entry_price else None,
            'total_dca_amount': float(self.total_dca_amount),
            'last_dca_price': float(self.last_dca_price) if self.last_dca_price else None,
            'last_dca_time': self.last_dca_time.isoformat() if self.last_dca_time else None
        }
```

---

### –ó–∞–¥–∞—á–∞ 2.3: –ú–æ–¥—É–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞–ø–∏—Ç–∞–ª–æ–º (RiskManager)

**–§—É–Ω–∫—Ü–∏–∏:**
- –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –æ–±—ä–µ–º–æ–≤
- –°—Ç–æ–ø-–ª–æ—Å—Å –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–æ—Ä—Ç—Ñ–µ–ª—è
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ drawdown

**–ü—Å–µ–≤–¥–æ–∫–æ–¥:**

```python
# src/risk/manager.py

from decimal import Decimal
from typing import Dict, Optional
import logging

logger = logging.getLogger(__name__)


class RiskManager:
    """
    –ú–µ–Ω–µ–¥–∂–µ—Ä —Ä–∏—Å–∫–æ–≤ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–∞–ø–∏—Ç–∞–ª–æ–º.
    """

    def __init__(
        self,
        exchange_client,
        db_manager,
        bot_id: int,
        config: Dict
    ):
        self.exchange_client = exchange_client
        self.db_manager = db_manager
        self.bot_id = bot_id
        self.config = config

        self.initial_capital = Decimal(str(config['capital']['total_capital_usdt']))
        self.max_drawdown_percent = Decimal(str(config['risk']['max_drawdown_percent']))
        self.min_order_amount = Decimal(str(config['risk']['min_order_amount_usdt']))
        self.max_open_orders = config['risk']['max_open_orders']

        self.current_capital: Optional[Decimal] = None
        self.peak_capital = self.initial_capital
        self.current_drawdown_percent = Decimal('0')

        logger.info(f"RiskManager initialized. Initial capital: {self.initial_capital} USDT")
        logger.info(f"Max drawdown: {self.max_drawdown_percent}%")

    async def update_portfolio_value(self) -> Decimal:
        """
        –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –ø–æ—Ä—Ç—Ñ–µ–ª—è (USDT + –±–∞–∑–æ–≤–∞—è –≤–∞–ª—é—Ç–∞ * —Ü–µ–Ω–∞).
        """
        try:
            balance = await self.exchange_client.fetch_balance()

            # –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–æ–≤
            usdt_balance = Decimal(str(balance.get('USDT', {}).get('free', 0)))

            # –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –±–∞–∑–æ–≤–æ–π –≤–∞–ª—é—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, BTC)
            base_currency = self.config['symbol'].split('/')[0]
            base_balance = Decimal(str(balance.get(base_currency, {}).get('free', 0)))

            # –¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ –±–∞–∑–æ–≤–æ–π –≤–∞–ª—é—Ç—ã
            ticker = await self.exchange_client.fetch_ticker(self.config['symbol'])
            base_price = Decimal(str(ticker['last']))

            # –û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—è
            self.current_capital = usdt_balance + (base_balance * base_price)

            # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∏–∫–∞ –∫–∞–ø–∏—Ç–∞–ª–∞
            if self.current_capital > self.peak_capital:
                self.peak_capital = self.current_capital

            # –†–∞—Å—á–µ—Ç —Ç–µ–∫—É—â–µ–≥–æ drawdown
            self.current_drawdown_percent = (
                (self.peak_capital - self.current_capital) / self.peak_capital * 100
            )

            logger.info(
                f"Portfolio value: {self.current_capital} USDT "
                f"(Peak: {self.peak_capital}, Drawdown: {self.current_drawdown_percent:.2f}%)"
            )

            return self.current_capital

        except Exception as e:
            logger.error(f"Failed to update portfolio value: {e}")
            return self.current_capital or self.initial_capital

    def check_max_drawdown_exceeded(self) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ drawdown.
        """
        if self.current_drawdown_percent >= self.max_drawdown_percent:
            logger.critical(
                f"MAX DRAWDOWN EXCEEDED! Current: {self.current_drawdown_percent:.2f}%, "
                f"Max allowed: {self.max_drawdown_percent}%"
            )
            return True
        return False

    def validate_order_amount(self, amount_usdt: Decimal) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –æ–±—ä–µ–º–∞ –æ—Ä–¥–µ—Ä–∞.
        """
        if amount_usdt < self.min_order_amount:
            logger.warning(
                f"Order amount {amount_usdt} USDT is below minimum {self.min_order_amount} USDT"
            )
            return False
        return True

    async def check_available_balance(self, required_usdt: Decimal) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞ –¥–ª—è –æ—Ä–¥–µ—Ä–∞.
        """
        try:
            balance = await self.exchange_client.fetch_balance()
            usdt_free = Decimal(str(balance.get('USDT', {}).get('free', 0)))

            if usdt_free < required_usdt:
                logger.warning(
                    f"Insufficient balance: Required {required_usdt} USDT, "
                    f"Available {usdt_free} USDT"
                )
                return False

            return True

        except Exception as e:
            logger.error(f"Failed to check balance: {e}")
            return False

    async def get_open_orders_count(self) -> int:
        """–ü–æ–ª—É—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤"""
        try:
            orders = await self.db_manager.get_open_orders(self.bot_id)
            return len(orders)
        except Exception as e:
            logger.error(f"Failed to get open orders count: {e}")
            return 0

    def check_max_open_orders(self, current_count: int) -> bool:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–∞ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤"""
        if current_count >= self.max_open_orders:
            logger.warning(
                f"Max open orders limit reached: {current_count}/{self.max_open_orders}"
            )
            return False
        return True

    async def should_stop_trading(self) -> bool:
        """
        –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏.
        """
        # –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—è
        await self.update_portfolio_value()

        # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å drawdown
        if self.check_max_drawdown_exceeded():
            if self.config['risk']['auto_stop_on_max_drawdown']:
                logger.critical("Auto-stop triggered due to max drawdown!")
                return True

        # –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ —É—Å–ª–æ–≤–∏—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏

        return False
```

---

## 5. –≠—Ç–∞–ø 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è, –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### –ó–∞–¥–∞—á–∞ 3.1: –°–æ–∑–¥–∞–Ω–∏–µ –≥–ª–∞–≤–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞-–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (BotOrchestrator)

**–§—É–Ω–∫—Ü–∏–∏:**
- –ó–∞–ø—É—Å–∫ –∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ Grid –∏ DCA –º–æ–¥—É–ª–µ–π
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º
- –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –º–µ–∂–¥—É —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π

**–í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```python
# src/core/orchestrator.py

import asyncio
from typing import Dict, Optional
import logging
from enum import Enum

logger = logging.getLogger(__name__)


class BotState(Enum):
    """–°–æ—Å—Ç–æ—è–Ω–∏—è –±–æ—Ç–∞"""
    STOPPED = "stopped"
    STARTING = "starting"
    RUNNING = "running"
    PAUSED = "paused"
    STOPPING = "stopping"
    ERROR = "error"
    EMERGENCY = "emergency"


class BotOrchestrator:
    """
    –ì–ª–∞–≤–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞.
    –ö–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π.
    """

    def __init__(
        self,
        config: Dict,
        exchange_client,
        db_manager,
        grid_engine,
        dca_engine,
        risk_manager,
        event_bus
    ):
        self.config = config
        self.exchange_client = exchange_client
        self.db_manager = db_manager
        self.grid_engine = grid_engine
        self.dca_engine = dca_engine
        self.risk_manager = risk_manager
        self.event_bus = event_bus

        self.state = BotState.STOPPED
        self.bot_id: Optional[int] = None

        logger.info("BotOrchestrator initialized")

    async def start(self):
        """–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞"""
        logger.info("=" * 80)
        logger.info("STARTING BOT")
        logger.info("=" * 80)

        self.state = BotState.STARTING

        try:
            # 1. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –±–æ—Ç–∞ –≤ –ë–î (–∏–ª–∏ –∑–∞–≥—Ä—É–∑–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π)
            bot_data = {
                'name': self.config['name'],
                'exchange': self.config['exchange'],
                'symbol': self.config['symbol'],
                'strategy_type': self.config['strategy_type'],
                'config': self.config,
                'state': 'running',
                'total_capital': self.config['capital']['total_capital_usdt'],
                'available_capital': self.config['capital']['total_capital_usdt']
            }
            bot = await self.db_manager.create_bot(bot_data)
            self.bot_id = bot.id

            # 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π
            logger.info("Initializing trading modules...")

            # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã
            ticker = await self.exchange_client.fetch_ticker(self.config['symbol'])
            current_price = Decimal(str(ticker['last']))
            logger.info(f"Current price: {current_price} {self.config['symbol']}")

            # 3. –ó–∞–ø—É—Å–∫ Grid Engine
            if self.config['grid']['enabled']:
                logger.info("Starting Grid Engine...")
                await self.grid_engine.initialize_grid(current_price)

                # –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ—Ä–¥–µ—Ä–æ–≤ –≤ —Ñ–æ–Ω–µ
                asyncio.create_task(self.grid_engine.monitor_orders())

            # 4. –ó–∞–ø—É—Å–∫ DCA Engine
            if self.config['dca']['enabled']:
                logger.info("Starting DCA Engine...")
                grid_lower = Decimal(str(self.config['grid']['lower_price']))

                # –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ü–µ–Ω—ã –¥–ª—è DCA –≤ —Ñ–æ–Ω–µ
                asyncio.create_task(self.dca_engine.monitor_price(grid_lower))

            # 5. –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ä–∏—Å–∫–æ–≤
            logger.info("Starting Risk Manager monitoring...")
            asyncio.create_task(self._monitor_risks())

            # 6. –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è
            await self._subscribe_to_events()

            self.state = BotState.RUNNING
            logger.info("=" * 80)
            logger.info("BOT IS NOW RUNNING")
            logger.info("=" * 80)

        except Exception as e:
            logger.error(f"Failed to start bot: {e}")
            self.state = BotState.ERROR
            raise

    async def stop(self):
        """–û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–æ—Ç–∞"""
        logger.info("Stopping bot...")
        self.state = BotState.STOPPING

        try:
            # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–æ–¥—É–ª–µ–π
            if self.grid_engine:
                await self.grid_engine.stop()

            if self.dca_engine:
                await self.dca_engine.stop()

            # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ –ë–î
            if self.bot_id:
                await self.db_manager.update_bot_state(self.bot_id, 'stopped')

            self.state = BotState.STOPPED
            logger.info("Bot stopped successfully")

        except Exception as e:
            logger.error(f"Error during bot stop: {e}")
            self.state = BotState.ERROR

    async def pause(self):
        """–ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏ (–æ—Ä–¥–µ—Ä–∞ –æ—Å—Ç–∞—é—Ç—Å—è)"""
        logger.info("Pausing bot...")
        # TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–∞—É–∑—É
        self.state = BotState.PAUSED

    async def resume(self):
        """–í–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–ª–∏"""
        logger.info("Resuming bot...")
        # TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤–æ–∑–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
        self.state = BotState.RUNNING

    async def emergency_stop(self):
        """–≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å –∑–∞–∫—Ä—ã—Ç–∏–µ–º –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π"""
        logger.critical("EMERGENCY STOP TRIGGERED!")
        self.state = BotState.EMERGENCY

        try:
            # –û—Ç–º–µ–Ω–∞ –≤—Å–µ—Ö –æ—Ç–∫—Ä—ã—Ç—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤
            if self.grid_engine:
                await self.grid_engine.cancel_all_orders()

            # TODO: –ó–∞–∫—Ä—ã—Ç—å –≤—Å–µ –ø–æ–∑–∏—Ü–∏–∏ –ø–æ —Ä—ã–Ω–∫—É

            await self.stop()

        except Exception as e:
            logger.error(f"Error during emergency stop: {e}")

    async def _monitor_risks(self):
        """–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∏—Å–∫–æ–≤ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ"""
        while self.state == BotState.RUNNING:
            try:
                # –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
                should_stop = await self.risk_manager.should_stop_trading()

                if should_stop:
                    logger.critical("Risk limits exceeded! Initiating emergency stop...")
                    await self.emergency_stop()
                    break

                # –ü–∞—É–∑–∞
                await asyncio.sleep(60)  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É

            except Exception as e:
                logger.error(f"Error in risk monitoring: {e}")
                await asyncio.sleep(60)

    async def _subscribe_to_events(self):
        """–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è –∏–∑ Event Bus"""
        # TODO: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –Ω–∞ —Å–æ–±—ã—Ç–∏—è Redis Pub/Sub
        pass

    def get_status(self) -> Dict:
        """–ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –±–æ—Ç–∞"""
        return {
            'state': self.state.value,
            'bot_id': self.bot_id,
            'grid_engine_running': self.grid_engine.is_running if self.grid_engine else False,
            'dca_engine_running': self.dca_engine.is_running if self.dca_engine else False,
            'dca_state': self.dca_engine.get_state() if self.dca_engine else {}
        }
```

---

### –ó–∞–¥–∞—á–∞ 3.2: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ—Å—Ç–æ–≥–æ Telegram-–±–æ—Ç–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
- `/start` - –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
- `/stop` - –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞
- `/status` - –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å
- `/balance` - –ü–æ–∫–∞–∑–∞—Ç—å –±–∞–ª–∞–Ω—Å
- `/orders` - –û—Ç–∫—Ä—ã—Ç—ã–µ –æ—Ä–¥–µ—Ä–∞
- `/pnl` - –ü—Ä–∏–±—ã–ª—å/—É–±—ã—Ç–æ–∫

**–ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**

```python
# src/interfaces/telegram_bot.py

from telegram import Update
from telegram.ext import (
    Application,
    CommandHandler,
    ContextTypes
)
import logging
from typing import Dict

logger = logging.getLogger(__name__)


class TelegramBotInterface:
    """
    Telegram –±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è DCA-Grid –±–æ—Ç–æ–º.
    """

    def __init__(
        self,
        token: str,
        chat_id: str,
        orchestrator
    ):
        self.token = token
        self.chat_id = chat_id
        self.orchestrator = orchestrator

        self.application = Application.builder().token(token).build()

        # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥
        self.application.add_handler(CommandHandler("start_bot", self.cmd_start_bot))
        self.application.add_handler(CommandHandler("stop_bot", self.cmd_stop_bot))
        self.application.add_handler(CommandHandler("status", self.cmd_status))
        self.application.add_handler(CommandHandler("balance", self.cmd_balance))
        self.application.add_handler(CommandHandler("orders", self.cmd_orders))
        self.application.add_handler(CommandHandler("pnl", self.cmd_pnl))
        self.application.add_handler(CommandHandler("emergency", self.cmd_emergency))

        logger.info("TelegramBotInterface initialized")

    async def start(self):
        """–ó–∞–ø—É—Å–∫ Telegram –±–æ—Ç–∞"""
        logger.info("Starting Telegram bot...")
        await self.application.initialize()
        await self.application.start()
        await self.application.updater.start_polling()

        # –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        await self.send_message(
            "ü§ñ DCA-Grid Bot Telegram Interface\n"
            "–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n"
            "/start_bot - –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞\n"
            "/stop_bot - –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞\n"
            "/status - –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å\n"
            "/balance - –ü–æ–∫–∞–∑–∞—Ç—å –±–∞–ª–∞–Ω—Å\n"
            "/orders - –û—Ç–∫—Ä—ã—Ç—ã–µ –æ—Ä–¥–µ—Ä–∞\n"
            "/pnl - –ü—Ä–∏–±—ã–ª—å/—É–±—ã—Ç–æ–∫\n"
            "/emergency - –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞"
        )

    async def cmd_start_bot(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """–ö–æ–º–∞–Ω–¥–∞ /start_bot"""
        try:
            await self.orchestrator.start()
            await update.message.reply_text("‚úÖ –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω!")
        except Exception as e:
            await update.message.reply_text(f"‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞: {e}")

    async def cmd_stop_bot(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """–ö–æ–º–∞–Ω–¥–∞ /stop_bot"""
        try:
            await self.orchestrator.stop()
            await update.message.reply_text("‚úÖ –ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω!")
        except Exception as e:
            await update.message.reply_text(f"‚ùå –û—à–∏–±–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏: {e}")

    async def cmd_status(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """–ö–æ–º–∞–Ω–¥–∞ /status"""
        try:
            status = self.orchestrator.get_status()

            message = (
                f"üìä **–°—Ç–∞—Ç—É—Å –±–æ—Ç–∞**\n\n"
                f"–°–æ—Å—Ç–æ—è–Ω–∏–µ: {status['state']}\n"
                f"Bot ID: {status['bot_id']}\n"
                f"Grid Engine: {'üü¢ Running' if status['grid_engine_running'] else 'üî¥ Stopped'}\n"
                f"DCA Engine: {'üü¢ Running' if status['dca_engine_running'] else 'üî¥ Stopped'}\n\n"
            )

            if status['dca_state']:
                dca = status['dca_state']
                message += (
                    f"**DCA Status:**\n"
                    f"Active: {dca['is_active']}\n"
                    f"Orders: {dca['dca_orders_count']}\n"
                    f"Avg Entry: {dca['average_entry_price']}\n"
                )

            await update.message.reply_text(message, parse_mode='Markdown')

        except Exception as e:
            await update.message.reply_text(f"‚ùå –û—à–∏–±–∫–∞: {e}")

    async def cmd_balance(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """–ö–æ–º–∞–Ω–¥–∞ /balance"""
        try:
            portfolio_value = await self.orchestrator.risk_manager.update_portfolio_value()

            message = (
                f"üí∞ **–ë–∞–ª–∞–Ω—Å –ø–æ—Ä—Ç—Ñ–µ–ª—è**\n\n"
                f"–¢–µ–∫—É—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: {portfolio_value:.2f} USDT\n"
                f"–ù–∞—á–∞–ª—å–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª: {self.orchestrator.risk_manager.initial_capital:.2f} USDT\n"
                f"–ü–∏–∫: {self.orchestrator.risk_manager.peak_capital:.2f} USDT\n"
                f"Drawdown: {self.orchestrator.risk_manager.current_drawdown_percent:.2f}%\n"
            )

            await update.message.reply_text(message, parse_mode='Markdown')

        except Exception as e:
            await update.message.reply_text(f"‚ùå –û—à–∏–±–∫–∞: {e}")

    async def cmd_orders(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """–ö–æ–º–∞–Ω–¥–∞ /orders"""
        try:
            orders = await self.orchestrator.db_manager.get_open_orders(
                self.orchestrator.bot_id
            )

            if not orders:
                await update.message.reply_text("–ù–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤")
                return

            message = f"üìù **–û—Ç–∫—Ä—ã—Ç—ã–µ –æ—Ä–¥–µ—Ä–∞** ({len(orders)})\n\n"

            for order in orders[:10]:  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ 10
                message += (
                    f"{order.side.upper()} {order.amount} @ {order.price}\n"
                    f"  {order.strategy_component} | Level: {order.grid_level}\n"
                )

            await update.message.reply_text(message, parse_mode='Markdown')

        except Exception as e:
            await update.message.reply_text(f"‚ùå –û—à–∏–±–∫–∞: {e}")

    async def cmd_pnl(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """–ö–æ–º–∞–Ω–¥–∞ /pnl"""
        try:
            # TODO: –†–∞—Å—á–µ—Ç PnL –Ω–∞ –æ—Å–Ω–æ–≤–µ trades
            await update.message.reply_text("‚ö†Ô∏è –§—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ")

        except Exception as e:
            await update.message.reply_text(f"‚ùå –û—à–∏–±–∫–∞: {e}")

    async def cmd_emergency(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """–ö–æ–º–∞–Ω–¥–∞ /emergency"""
        await update.message.reply_text("üö® –ò–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω–∞ —ç–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞...")

        try:
            await self.orchestrator.emergency_stop()
            await update.message.reply_text("‚úÖ –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞")
        except Exception as e:
            await update.message.reply_text(f"‚ùå –û—à–∏–±–∫–∞: {e}")

    async def send_message(self, text: str):
        """–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —á–∞—Ç"""
        try:
            await self.application.bot.send_message(
                chat_id=self.chat_id,
                text=text
            )
        except Exception as e:
            logger.error(f"Failed to send Telegram message: {e}")

    async def notify_order_filled(self, order: Dict):
        """–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–∏ –æ—Ä–¥–µ—Ä–∞"""
        message = (
            f"‚úÖ **–û—Ä–¥–µ—Ä –∏—Å–ø–æ–ª–Ω–µ–Ω**\n\n"
            f"{order['side'].upper()} {order['amount']} {order['symbol']}\n"
            f"–¶–µ–Ω–∞: {order['price']}\n"
            f"–ö–æ–º–ø–æ–Ω–µ–Ω—Ç: {order['strategy_component']}"
        )
        await self.send_message(message)

    async def notify_error(self, error_msg: str):
        """–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ"""
        message = f"‚ùå **–û—à–∏–±–∫–∞**\n\n{error_msg}"
        await self.send_message(message)

    async def stop(self):
        """–û—Å—Ç–∞–Ω–æ–≤–∫–∞ Telegram –±–æ—Ç–∞"""
        logger.info("Stopping Telegram bot...")
        await self.application.stop()
        await self.application.shutdown()
```

---

### –ó–∞–¥–∞—á–∞ 3.3: –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**docker-compose.yml:**

```yaml
version: '3.8'

services:
  # –û—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç
  bot:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: dca-grid-bot
    restart: unless-stopped
    depends_on:
      - postgres
      - redis
    volumes:
      - ./config:/app/config
      - ./logs:/app/logs
      - ./secrets:/app/secrets
    env_file:
      - .env
    networks:
      - bot-network
    command: python src/main.py

  # PostgreSQL
  postgres:
    image: postgres:15-alpine
    container_name: dca-grid-postgres
    restart: unless-stopped
    environment:
      POSTGRES_USER: ${POSTGRES_USER:-botuser}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD:-botpassword}
      POSTGRES_DB: ${POSTGRES_DB:-dcagrid_bot}
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"
    networks:
      - bot-network

  # Redis
  redis:
    image: redis:7-alpine
    container_name: dca-grid-redis
    restart: unless-stopped
    command: redis-server --appendonly yes
    volumes:
      - redis_data:/data
    ports:
      - "6379:6379"
    networks:
      - bot-network

  # Grafana (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  grafana:
    image: grafana/grafana:latest
    container_name: dca-grid-grafana
    restart: unless-stopped
    ports:
      - "3000:3000"
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=${GRAFANA_PASSWORD:-admin}
    volumes:
      - grafana_data:/var/lib/grafana
    networks:
      - bot-network

volumes:
  postgres_data:
  redis_data:
  grafana_data:

networks:
  bot-network:
    driver: bridge
```

**Dockerfile:**

```dockerfile
FROM python:3.11-slim

WORKDIR /app

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
RUN apt-get update && apt-get install -y \
    gcc \
    g++ \
    make \
    wget \
    && rm -rf /var/lib/apt/lists/*

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ TA-Lib
RUN wget http://prdownloads.sourceforge.net/ta-lib/ta-lib-0.4.0-src.tar.gz && \
    tar -xzf ta-lib-0.4.0-src.tar.gz && \
    cd ta-lib/ && \
    ./configure --prefix=/usr && \
    make && \
    make install && \
    cd .. && \
    rm -rf ta-lib ta-lib-0.4.0-src.tar.gz

# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ requirements
COPY requirements.txt .

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
RUN pip install --no-cache-dir -r requirements.txt

# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
COPY . .

# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
RUN mkdir -p /app/logs /app/secrets

# –ó–∞–ø—É—Å–∫
CMD ["python", "src/main.py"]
```

**–°–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è (scripts/deploy.sh):**

```bash
#!/bin/bash

# deploy.sh - –°–∫—Ä–∏–ø—Ç –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –±–æ—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

set -e

echo "====================================="
echo "DCA-Grid Bot Deployment Script"
echo "====================================="

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è Docker
if ! command -v docker &> /dev/null; then
    echo "‚ùå Docker –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Docker –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞."
    exit 1
fi

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è docker-compose
if ! command -v docker-compose &> /dev/null; then
    echo "‚ùå docker-compose –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω."
    exit 1
fi

echo "‚úÖ Docker –∏ docker-compose —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ .env —Ñ–∞–π–ª–∞
if [ ! -f .env ]; then
    echo "‚ùå .env —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ .env.example –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –µ–≥–æ."
    exit 1
fi

echo "‚úÖ .env —Ñ–∞–π–ª –Ω–∞–π–¥–µ–Ω"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ config.yaml
if [ ! -f config/config.yaml ]; then
    echo "‚ùå config/config.yaml –Ω–µ –Ω–∞–π–¥–µ–Ω."
    exit 1
fi

echo "‚úÖ config.yaml –Ω–∞–π–¥–µ–Ω"

# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
mkdir -p logs secrets

# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
echo ""
echo "üî® –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞..."
docker-compose build

# –ó–∞–ø—É—Å–∫ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
echo ""
echo "üóÑÔ∏è  –ó–∞–ø—É—Å–∫ PostgreSQL –∏ Redis..."
docker-compose up -d postgres redis

# –û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ PostgreSQL
echo "‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ PostgreSQL..."
sleep 10

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
echo ""
echo "üóÑÔ∏è  –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö..."
docker-compose run --rm bot python scripts/init_db.py

# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
echo ""
echo "üöÄ –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞..."
docker-compose up -d bot

echo ""
echo "====================================="
echo "‚úÖ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!"
echo "====================================="
echo ""
echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞:"
echo "  docker-compose ps"
echo ""
echo "–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:"
echo "  docker-compose logs -f bot"
echo ""
echo "–û—Å—Ç–∞–Ω–æ–≤–∫–∞:"
echo "  docker-compose down"
echo ""
```

---

## 6. –≠—Ç–∞–ø 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –ó–∞–¥–∞—á–∞ 4.1: –ú–æ–¥—É–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

**–ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–æ–≤ —Å pytest:**

```python
# tests/unit/test_grid_engine.py

import pytest
from decimal import Decimal
from src.strategies.grid_engine import GridEngine

@pytest.fixture
def grid_config():
    return {
        'symbol': 'BTC/USDT',
        'capital': {
            'total_capital_usdt': 1000,
            'grid_allocation_percent': 60
        },
        'grid': {
            'type': 'static',
            'upper_price': 45000,
            'lower_price': 40000,
            'grid_levels': 10,
            'profit_per_level_percent': 0.5
        }
    }

def test_calculate_grid_levels_static(grid_config):
    """–¢–µ—Å—Ç —Ä–∞—Å—á–µ—Ç–∞ —É—Ä–æ–≤–Ω–µ–π –¥–ª—è static grid"""
    engine = GridEngine(None, None, 1, grid_config)
    levels = engine.calculate_grid_levels()

    assert len(levels) == 10
    assert levels[0] == Decimal('40000')
    assert levels[-1] == Decimal('45000')

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏
    step = (Decimal('45000') - Decimal('40000')) / 9
    for i in range(1, len(levels)):
        assert abs(levels[i] - levels[i-1] - step) < Decimal('0.01')

def test_calculate_order_amounts(grid_config):
    """–¢–µ—Å—Ç —Ä–∞—Å—á–µ—Ç–∞ –æ–±—ä–µ–º–æ–≤ –æ—Ä–¥–µ—Ä–æ–≤"""
    engine = GridEngine(None, None, 1, grid_config)
    levels = engine.calculate_grid_levels()
    amounts = engine.calculate_order_amounts(levels)

    assert len(amounts) == len(levels)

    # –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ —Å—É–º–º–∞ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª
    # (—É—á–∏—Ç—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ buy –æ—Ä–¥–µ—Ä–∞)
    total_buy_capital = sum(
        float(amounts[i] * levels[i])
        for i in range(len(levels) // 2)
    )
    assert total_buy_capital <= 600  # 60% –æ—Ç 1000
```

---

### –ó–∞–¥–∞—á–∞ 4.2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö (–±—ç–∫—Ç–µ—Å—Ç)

**–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è:** –°–æ–∑–¥–∞—Ç—å —Å–∏–º—É–ª—è—Ç–æ—Ä —Ä—ã–Ω–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ.

```python
# tests/backtest/market_simulator.py

from typing import List, Dict
from decimal import Decimal
from datetime import datetime

class MarketSimulator:
    """
    –°–∏–º—É–ª—è—Ç–æ—Ä —Ä—ã–Ω–∫–∞ –¥–ª—è –±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥–∞.
    –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ.
    """

    def __init__(self, historical_data: List[Dict]):
        """
        historical_data: [
            {'timestamp': ..., 'open': ..., 'high': ..., 'low': ..., 'close': ...},
            ...
        ]
        """
        self.data = historical_data
        self.current_index = 0
        self.orders = []  # –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤

    def get_current_price(self) -> Decimal:
        """–ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É"""
        return Decimal(str(self.data[self.current_index]['close']))

    def create_limit_order(
        self,
        side: str,
        amount: float,
        price: float
    ) -> Dict:
        """–°–æ–∑–¥–∞—Ç—å –ª–∏–º–∏—Ç–Ω—ã–π –æ—Ä–¥–µ—Ä"""
        order = {
            'id': f"order_{len(self.orders)}",
            'side': side,
            'amount': amount,
            'price': Decimal(str(price)),
            'status': 'open',
            'filled': 0
        }
        self.orders.append(order)
        return order

    def step(self):
        """–®–∞–≥ —Å–∏–º—É–ª—è—Ü–∏–∏ (–ø–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–π —Å–≤–µ—á–µ)"""
        if self.current_index >= len(self.data) - 1:
            return False

        self.current_index += 1
        candle = self.data[self.current_index]

        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Ä–¥–µ—Ä–æ–≤
        high = Decimal(str(candle['high']))
        low = Decimal(str(candle['low']))

        for order in self.orders:
            if order['status'] == 'open':
                if order['side'] == 'buy' and order['price'] >= low:
                    order['status'] = 'filled'
                    order['filled'] = order['amount']
                elif order['side'] == 'sell' and order['price'] <= high:
                    order['status'] = 'filled'
                    order['filled'] = order['amount']

        return True

    def get_filled_orders(self) -> List[Dict]:
        """–ü–æ–ª—É—á–∏—Ç—å –∏—Å–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –æ—Ä–¥–µ—Ä–∞"""
        return [o for o in self.orders if o['status'] == 'filled']

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
# simulator = MarketSimulator(historical_data)
# while simulator.step():
#     current_price = simulator.get_current_price()
#     # –õ–æ–≥–∏–∫–∞ –±–æ—Ç–∞
```

---

### –ó–∞–¥–∞—á–∞ 4.3: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ "–ø–µ—Å–æ—á–Ω–∏—Ü–µ" (testnet) –±–∏—Ä–∂

**Checklist –¥–ª—è testnet —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

1. ‚úÖ –ü–æ–ª—É—á–∏—Ç—å testnet API –∫–ª—é—á–∏
   - Binance: https://testnet.binance.vision/
   - Bybit: https://testnet.bybit.com/

2. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è testnet
   ```yaml
   bot:
     testnet: true
   ```

3. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –∫–∞–ø–∏—Ç–∞–ª–æ–º

4. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏:
   - –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ä–¥–µ—Ä–æ–≤
   - –ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ
   - –ü–µ—Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞ Grid
   - –ê–∫—Ç–∏–≤–∞—Ü–∏—è DCA
   - –†–∞–±–æ—Ç–∞ Telegram –±–æ—Ç–∞
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

5. ‚úÖ –û—Å—Ç–∞–≤–∏—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ 24-48 —á–∞—Å–æ–≤

6. ‚úÖ –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏ –∏ –º–µ—Ç—Ä–∏–∫–∏

---

### –ó–∞–¥–∞—á–∞ 4.4: –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ —á–∞—Å—Ç–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ

**–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:**

**1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (Ubuntu 22.04):**

```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
sudo apt-get update && sudo apt-get upgrade -y

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ docker-compose
sudo apt-get install docker-compose -y

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É docker
sudo usermod -aG docker $USER

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ firewall (UFW)
sudo ufw allow 22/tcp    # SSH
sudo ufw allow 443/tcp   # HTTPS (–µ—Å–ª–∏ –±—É–¥–µ—Ç Web UI)
sudo ufw enable
```

**2. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:**

```bash
git clone https://github.com/your-repo/dca-grid-bot.git
cd dca-grid-bot
```

**3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**

```bash
# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–æ–≤
cp .env.example .env
cp config/config.yaml.example config/config.yaml

# –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ .env
nano .env
# –ó–∞–ø–æ–ª–Ω–∏—Ç—å API –∫–ª—é—á–∏, –ø–∞—Ä–æ–ª–∏ –ë–î, Telegram —Ç–æ–∫–µ–Ω

# –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ config.yaml
nano config/config.yaml
# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –±–æ—Ç–∞

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
python scripts/generate_keys.py
# –î–æ–±–∞–≤–∏—Ç—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª—é—á –≤ .env
```

**4. –ó–∞–ø—É—Å–∫:**

```bash
# –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ deploy —Å–∫—Ä–∏–ø—Ç
chmod +x scripts/deploy.sh
./scripts/deploy.sh

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é
docker-compose up -d
```

**5. –ü—Ä–æ–≤–µ—Ä–∫–∞:**

```bash
# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose ps

# –õ–æ–≥–∏
docker-compose logs -f bot

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î
docker-compose exec postgres psql -U botuser -d dcagrid_bot -c "SELECT * FROM bots;"
```

**6. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:**

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ systemd service (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ docker restart policy)
sudo nano /etc/systemd/system/dca-grid-bot.service
```

```ini
[Unit]
Description=DCA Grid Bot
Requires=docker.service
After=docker.service

[Service]
Type=oneshot
RemainAfterExit=yes
WorkingDirectory=/home/user/dca-grid-bot
ExecStart=/usr/bin/docker-compose up -d
ExecStop=/usr/bin/docker-compose down
TimeoutStartSec=0

[Install]
WantedBy=multi-user.target
```

```bash
sudo systemctl enable dca-grid-bot
sudo systemctl start dca-grid-bot
```

---

### –ó–∞–¥–∞—á–∞ 4.5: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑–æ–≤–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

**1. –õ–æ–≥–∏ —á–µ—Ä–µ–∑ journalctl:**

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
sudo journalctl -u docker -f

# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker logs -f dca-grid-bot --tail 100
```

**2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ uptime:**

```bash
# –ü—Ä–æ—Å—Ç–æ–π —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ (check_bot.sh)
#!/bin/bash
if [ $(docker ps -q -f name=dca-grid-bot | wc -l) -eq 0 ]; then
    echo "Bot is down! Restarting..."
    cd /home/user/dca-grid-bot
    docker-compose up -d bot
    # –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
fi

# –î–æ–±–∞–≤–∏—Ç—å –≤ cron (–∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç)
*/5 * * * * /home/user/check_bot.sh
```

**3. Grafana + Prometheus (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**

**–î–æ–±–∞–≤–∏—Ç—å –≤ docker-compose.yml:**

```yaml
  prometheus:
    image: prom/prometheus:latest
    container_name: dca-grid-prometheus
    restart: unless-stopped
    volumes:
      - ./monitoring/prometheus.yml:/etc/prometheus/prometheus.yml
      - prometheus_data:/prometheus
    ports:
      - "9090:9090"
    networks:
      - bot-network

  # Grafana —É–∂–µ –µ—Å—Ç—å –≤ compose —Ñ–∞–π–ª–µ
```

**prometheus.yml:**

```yaml
global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'bot'
    static_configs:
      - targets: ['bot:8000']  # –ï—Å–ª–∏ –±–æ—Ç —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –º–µ—Ç—Ä–∏–∫–∏
```

**–í –∫–æ–¥–µ –±–æ—Ç–∞ (src/main.py):**

```python
from prometheus_client import start_http_server, Counter, Gauge

# –ú–µ—Ç—Ä–∏–∫–∏
orders_created = Counter('bot_orders_created_total', 'Total orders created')
current_balance = Gauge('bot_balance_usdt', 'Current balance in USDT')
open_orders = Gauge('bot_open_orders', 'Number of open orders')

# –ó–∞–ø—É—Å–∫ Prometheus exporter
start_http_server(8000)

# –í –∫–æ–¥–µ –æ–±–Ω–æ–≤–ª—è—Ç—å –º–µ—Ç—Ä–∏–∫–∏:
# orders_created.inc()
# current_balance.set(1234.56)
```

---

## 7. –≠—Ç–∞–ø 5: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ –¥–∞–ª—å–Ω–µ–π—à–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ

### –ó–∞–¥–∞—á–∞ 5.1: –ù–∞–ø–∏—Å–∞–Ω–∏–µ README.md

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ README:**

```markdown
# DCA-Grid Trading Bot

–ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π —Ç–æ—Ä–≥–æ–≤—ã–π –±–æ—Ç –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã—Ö –±–∏—Ä–∂, –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É—é—â–∏–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ Dollar-Cost Averaging (DCA) –∏ Grid Trading.

## ‚ú® –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- üîÑ –ì–∏–±—Ä–∏–¥–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è Grid + DCA
- üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ API –∫–ª—é—á–µ–π (—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ)
- üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å—Ç–æ–ø-–ª–æ—Å—Å
- üí¨ Telegram –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- üê≥ Docker-based —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
- üìà –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –±–∏—Ä–∂ (Binance, Bybit, OKX)
- üìâ Testnet —Ä–µ–∂–∏–º –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.11+
- Docker & Docker Compose
- –ê–∫–∫–∞—É–Ω—Ç –Ω–∞ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–æ–π –±–∏—Ä–∂–µ —Å API –∫–ª—é—á–∞–º–∏

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone https://github.com/your-repo/dca-grid-bot.git
cd dca-grid-bot
```

2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
```bash
cp .env.example .env
cp config/config.yaml.example config/config.yaml
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç—å:
```bash
./scripts/deploy.sh
```

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ](docs/installation.md)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–æ—Ç–∞](docs/configuration.md)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã](docs/architecture.md)
- [API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](docs/api.md)
- [FAQ](docs/faq.md)

## ‚ö†Ô∏è Disclaimer

–≠—Ç–æ—Ç –±–æ—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª–µ–π.
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–∞ —Å–≤–æ–π —Ä–∏—Å–∫. –ê–≤—Ç–æ—Ä—ã –Ω–µ –Ω–µ—Å—É—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ—Ç–µ—Ä–∏.

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License
```

---

### –ó–∞–¥–∞—á–∞ 5.2: –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥—Ä–æ–±–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –ø–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º—É —Ñ–∞–π–ª—É

**docs/configuration.md:**

```markdown
# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ config.yaml

### Bot Settings

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|----------|-----|----------|--------|
| `name` | string | –ò–º—è –±–æ—Ç–∞ | "BTC-USDT-Bot-1" |
| `exchange` | string | –ë–∏—Ä–∂–∞ | "binance" |
| `symbol` | string | –¢–æ—Ä–≥–æ–≤–∞—è –ø–∞—Ä–∞ | "BTC/USDT" |
| `strategy_type` | string | –¢–∏–ø —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ | "hybrid" |

### Capital

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –î–∏–∞–ø–∞–∑–æ–Ω |
|----------|-----|----------|----------|
| `total_capital_usdt` | decimal | –û–±—â–∏–π –∫–∞–ø–∏—Ç–∞–ª | > 0 |
| `grid_allocation_percent` | int | % –¥–ª—è Grid | 0-100 |
| `dca_allocation_percent` | int | % –¥–ª—è DCA | 0-100 |

**–í–∞–∂–Ω–æ:** `grid_allocation_percent + dca_allocation_percent = 100`

... (–ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ)
```

---

### –ó–∞–¥–∞—á–∞ 5.3: –ü–ª–∞–Ω –¥–∞–ª—å–Ω–µ–π—à–∏—Ö —É–ª—É—á—à–µ–Ω–∏–π

**Roadmap:**

#### **–í–µ—Ä—Å–∏—è 2.0 (3-6 –º–µ—Å—è—Ü–µ–≤)**

1. **Web UI:**
   - React dashboard –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
   - –ì—Ä–∞—Ñ–∏–∫–∏ PnL –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
   - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ UI

2. **–ú—É–ª—å—Ç–∏–∞–∫–∫–∞—É–Ω—Ç–Ω–æ—Å—Ç—å:**
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –±–æ—Ç–æ–≤
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –±–∏—Ä–∂–∞–º–∏
   - –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

3. **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞:**
   - –ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥ —á–µ—Ä–µ–∑ UI
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
   - Sharpe Ratio, Maximum Drawdown, Win Rate

#### **–í–µ—Ä—Å–∏—è 3.0 (6-12 –º–µ—Å—è—Ü–µ–≤)**

4. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏:**
   - Mean Reversion
   - Momentum Trading
   - Arbitrage

5. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å TradingView:**
   - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤ –∏–∑ TV
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤

6. **Machine Learning:**
   - –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ Grid
   - –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π DCA –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä—ã–Ω–æ—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π

---

## 8. –û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 8.1 –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏

| –†–∏—Å–∫ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–ª–∏—è–Ω–∏–µ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|------|-------------|---------|-----------|
| **–°–±–æ–π API –±–∏—Ä–∂–∏** | –í—ã—Å–æ–∫–∞—è | –í—ã—Å–æ–∫–æ–µ | Retry-–ª–æ–≥–∏–∫–∞, fallback –Ω–∞ –¥—Ä—É–≥—É—é –±–∏—Ä–∂—É, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è |
| **–û—à–∏–±–∫–∏ –≤ –ª–æ–≥–∏–∫–µ –±–æ—Ç–∞** | –°—Ä–µ–¥–Ω—è—è | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ | –¢—â–∞—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, testnet, –Ω–∞—á–∞—Ç—å —Å –º–∞–ª—ã—Ö —Å—É–º–º |
| **Rate limit –ø—Ä–µ–≤—ã—à–µ–Ω** | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω–µ–µ | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `enableRateLimit=True` –≤ CCXT, backoff |
| **–ü–æ—Ç–µ—Ä—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è** | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–æ–µ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è |
| **–ö–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è API –∫–ª—é—á–µ–π** | –ù–∏–∑–∫–∞—è | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ | –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ, IP whitelist, –∑–∞–ø—Ä–µ—Ç withdrawal |
| **–ë–∞–≥ –≤ –∫–æ–¥–µ -> –ø–æ—Ç–µ—Ä–∏** | –°—Ä–µ–¥–Ω—è—è | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ | Code review, unit tests, –º–∞–ª—ã–µ —Å—É–º–º—ã –≤ –Ω–∞—á–∞–ª–µ |
| **–ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –ë–î** | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–∑–º–µ—Ä–∞ |

---

### 8.2 –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ä–∏—Å–∫–∏

| –†–∏—Å–∫ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–ª–∏—è–Ω–∏–µ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|------|-------------|---------|-----------|
| **–†–µ–∑–∫–æ–µ –ø–∞–¥–µ–Ω–∏–µ —Ä—ã–Ω–∫–∞** | –í—ã—Å–æ–∫–∞—è | –í—ã—Å–æ–∫–æ–µ | –°—Ç–æ–ø-–ª–æ—Å—Å, DCA —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º, –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è |
| **"–ó–∞—Å—Ç—Ä–µ–≤–∞–Ω–∏–µ" –≤ DCA** | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–æ–µ | –õ–∏–º–∏—Ç max_dca_orders, —Ä–µ–∑–µ—Ä–≤–Ω—ã–π –∫–∞–ø–∏—Ç–∞–ª |
| **–í—ã—Å–æ–∫–∏–µ –∫–æ–º–∏—Å—Å–∏–∏ —Å—ä–µ–¥–∞—é—Ç –ø—Ä–∏–±—ã–ª—å** | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω–µ–µ | Post-only –æ—Ä–¥–µ—Ä–∞ (maker), –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —á–∞—Å—Ç–æ—Ç—ã —Å–¥–µ–ª–æ–∫ |
| **–ü—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ (slippage)** | –ù–∏–∑–∫–∞—è | –ù–∏–∑–∫–æ–µ | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏–º–∏—Ç–Ω—ã–µ –æ—Ä–¥–µ—Ä–∞ |
| **–õ–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å –ø–∞—Ä—ã** | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | –í—ã–±–∏—Ä–∞—Ç—å –ø–∞—Ä—ã —Å –≤—ã—Å–æ–∫–æ–π –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å—é (BTC/USDT, ETH/USDT) |
| **–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å** | –í—ã—Å–æ–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Grid –∫ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ |

---

### 8.3 –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

#### **–î–æ –∑–∞–ø—É—Å–∫–∞:**

1. ‚úÖ **–ü—Ä–æ—á–∏—Ç–∞—Ç—å –≤—Å—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é**
   - –ü–æ–Ω—è—Ç—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Grid –∏ DCA
   - –ò–∑—É—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

2. ‚úÖ **–ü—Ä–æ–≤–µ—Å—Ç–∏ –±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥**
   - –ù–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
   - –ú–∏–Ω–∏–º—É–º 3 –º–µ—Å—è—Ü–∞ –¥–∞–Ω–Ω—ã—Ö

3. ‚úÖ **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ testnet**
   - –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞ 1-2 –Ω–µ–¥–µ–ª–∏
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

4. ‚úÖ **–ù–∞—á–∞—Ç—å —Å –º–∞–ª—ã—Ö —Å—É–º–º**
   - $100-$500 –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
   - –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å

#### **–í—ã–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**

1. **Grid:**
   - –î–∏–∞–ø–∞–∑–æ–Ω: ¬±10-15% –æ—Ç —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã
   - –£—Ä–æ–≤–Ω–∏: 15-25 –¥–ª—è –Ω–∞—á–∞–ª–∞
   - –ü—Ä–∏–±—ã–ª—å –Ω–∞ —É—Ä–æ–≤–µ–Ω—å: 0.5-1%

2. **DCA:**
   - –ê–∫—Ç–∏–≤–∞—Ü–∏—è: 5-7% –Ω–∏–∂–µ –Ω–∏–∂–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã Grid
   - –®–∞–≥: 3-5%
   - Max –æ—Ä–¥–µ—Ä–æ–≤: 3-5
   - –¶–µ–ª–µ–≤–∞—è –ø—Ä–∏–±—ã–ª—å: 5-10%

3. **Risk:**
   - Max drawdown: 15-20%
   - –í—Å–µ–≥–¥–∞ –≤–∫–ª—é—á–∞—Ç—å auto-stop

#### **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**

1. ‚è∞ **–ü–µ—Ä–≤–∞—è –Ω–µ–¥–µ–ª—è:** –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∫–∞–∂–¥—ã–µ 2-4 —á–∞—Å–∞
2. ‚è∞ **–ü–µ—Ä–≤—ã–π –º–µ—Å—è—Ü:** –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
3. ‚è∞ **–î–∞–ª–µ–µ:** –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑

#### **–ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö:**

1. **–ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `docker-compose logs -f bot`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å API –∫–ª—é—á–∏ –≤ `.env`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –±–∏—Ä–∂–µ–π

2. **–û—Ä–¥–µ—Ä–∞ –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –æ–±—ä–µ–º—ã –¥–ª—è –±–∏—Ä–∂–∏
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å rate limits

3. **DCA –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª—Å—è —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ:**
   - –£–≤–µ–ª–∏—á–∏—Ç—å `activation_drop_percent`
   - –ü–µ—Ä–µ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∏–∂–Ω—é—é –≥—Ä–∞–Ω–∏—Ü—É Grid

4. **–ü—Ä–∏–±—ã–ª—å –Ω–∏–∂–µ –æ–∂–∏–¥–∞–µ–º–æ–π:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–º–∏—Å—Å–∏–∏
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Grid
   - –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Å–¥–µ–ª–æ–∫

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–î–∞–Ω–Ω—ã–π –ø–ª–∞–Ω –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø–æ–ª–Ω—É—é –¥–æ—Ä–æ–∂–Ω—É—é –∫–∞—Ä—Ç—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–≥–æ DCA-Grid —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞ –æ—Ç –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –¥–æ production-—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è.

### –û—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–µ —Å—Ä–æ–∫–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

- **–≠—Ç–∞–ø 0-1:** 2-3 –Ω–µ–¥–µ–ª–∏ (–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
- **–≠—Ç–∞–ø 2:** 3-4 –Ω–µ–¥–µ–ª–∏ (—Ç–æ—Ä–≥–æ–≤—ã–µ –º–æ–¥—É–ª–∏)
- **–≠—Ç–∞–ø 3:** 2-3 –Ω–µ–¥–µ–ª–∏ (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è, –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
- **–≠—Ç–∞–ø 4:** 2-4 –Ω–µ–¥–µ–ª–∏ (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)
- **–≠—Ç–∞–ø 5:** 1 –Ω–µ–¥–µ–ª—è (–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)

**–û–±—â–µ–µ –≤—Ä–µ–º—è:** 10-15 –Ω–µ–¥–µ–ª—å (2.5-4 –º–µ—Å—è—Ü–∞) –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ 1-2 —á–µ–ª–æ–≤–µ–∫–∞ full-time.

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —É—Å–ø–µ—Ö–∞:

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–µ–∂–¥–µ –≤—Å–µ–≥–æ:** –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ, testnet, –º–∞–ª—ã–µ —Å—É–º–º—ã –≤ –Ω–∞—á–∞–ª–µ
2. **–¢—â–∞—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** Unit, integration, backtesting, paper trading
3. **–ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ù–∞—á–∞—Ç—å –ø—Ä–æ—Å—Ç–æ, —É—Å–ª–æ–∂–Ω—è—Ç—å –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –í—Å–µ–≥–¥–∞ –∑–Ω–∞—Ç—å, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
5. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏:** –°—Ç–æ–ø-–ª–æ—Å—Å—ã, –ª–∏–º–∏—Ç—ã, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞—â–∏—Ç—ã

### –î–∞–ª—å–Ω–µ–π—à–∏–µ —à–∞–≥–∏:

1. –°–æ–∑–¥–∞—Ç—å GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. –ù–∞—á–∞—Ç—å —Å –≠—Ç–∞–ø–∞ 0 ‚Äî –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
3. –†–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, —ç—Ç–∞–ø –∑–∞ —ç—Ç–∞–ø–æ–º
4. –ö–æ–º–º–∏—Ç–∏—Ç—å —á–∞—Å—Ç–æ, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ
5. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ —Ö–æ–¥—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

**–£–¥–∞—á–∏ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ! üöÄ**

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω: 2026-02-05*
*–í–µ—Ä—Å–∏—è: 1.0*
*–ê–≤—Ç–æ—Ä: DCA-Grid Bot Development Team*
