# Production Configuration for Trend-Follower Strategy
# TRADERAGENT Bot - Adaptive Trend-Following Trading
#
# IMPORTANT: Review all settings before deploying to production
# Start with dry_run: true and small position sizes for testing

# Database Configuration
database_url: postgresql+asyncpg://user:password@localhost/traderagent
database_pool_size: 5

# Logging Configuration
log_level: INFO         # Use INFO for production, DEBUG for troubleshooting
log_to_file: true
log_to_console: true
json_logs: true         # Structured logs for production monitoring

# Encryption Key (Generate with: python -c "import os, base64; print(base64.b64encode(os.urandom(32)).decode())")
# SECURITY: Store this in environment variable ENCRYPTION_KEY
encryption_key: REPLACE_WITH_YOUR_BASE64_ENCODED_KEY

# Bot Configurations
bots:
  # ETH/USDT Trend-Follower - 1H Timeframe
  - version: 1
    name: eth_trend_follower_1h
    symbol: ETH/USDT
    strategy: trend_follower

    exchange:
      exchange_id: binance
      credentials_name: binance_production  # Ensure credentials are stored in database
      sandbox: false                        # PRODUCTION MODE
      rate_limit: true

    trend_follower:
      enabled: true

      # Market analysis settings
      ema_fast_period: 20     # Fast EMA (20 periods)
      ema_slow_period: 50     # Slow EMA (50 periods)
      atr_period: 14          # ATR for volatility measurement
      rsi_period: 14          # RSI for momentum confirmation

      # Entry settings
      volume_multiplier: "1.5"        # Require 150% of average volume
      atr_filter_threshold: "0.05"    # Min 5% ATR for volatility

      # Dynamic TP/SL - CONSERVATIVE settings for production
      # Sideways market (low volatility)
      tp_atr_multiplier_sideways: "1.0"   # Conservative TP in sideways
      sl_atr_multiplier_sideways: "0.8"   # Tight SL in sideways

      # Weak trend
      tp_atr_multiplier_weak: "1.5"       # Moderate TP in weak trend

      # Strong trend
      tp_atr_multiplier_strong: "2.0"     # Aggressive TP in strong trend (reduced from 2.5)

      # Trending market SL
      sl_atr_multiplier_trend: "1.2"      # Wider SL in trend (increased from 1.0)

      # Risk management - CONSERVATIVE for production
      risk_per_trade_pct: "0.01"          # 1% risk per trade (conservative)
      max_position_size_usd: "3000"       # Max $3000 per position
      max_daily_loss_usd: "300"           # Max $300 daily loss
      max_positions: 2                    # Max 2 concurrent positions

      # Logging
      log_all_signals: true               # Log all signals for analysis

    risk_management:
      max_position_size: "3000"           # Must match strategy max_position_size_usd
      stop_loss_percentage: null          # Managed by strategy (ATR-based)
      max_daily_loss: "300"               # Must match strategy max_daily_loss_usd
      min_order_size: "10"                # Exchange minimum

    notifications:
      enabled: true
      telegram_bot_token: null            # Set via env: TELEGRAM_BOT_TOKEN
      telegram_chat_id: null              # Set via env: TELEGRAM_ALLOWED_CHAT_IDS
      notify_on_trade: true
      notify_on_error: true

    dry_run: false      # PRODUCTION MODE - Real trading!
    auto_start: false   # Manual start recommended for safety

  # BTC/USDT Trend-Follower - 4H Timeframe (Alternative setup)
  - version: 1
    name: btc_trend_follower_4h
    symbol: BTC/USDT
    strategy: trend_follower

    exchange:
      exchange_id: binance
      credentials_name: binance_production
      sandbox: false
      rate_limit: true

    trend_follower:
      enabled: true

      # Market analysis settings - 4H timeframe (longer periods)
      ema_fast_period: 25     # Slightly longer for 4H
      ema_slow_period: 60     # Slightly longer for 4H
      atr_period: 14
      rsi_period: 14

      # Entry settings
      volume_multiplier: "1.3"        # Less strict volume requirement for 4H
      atr_filter_threshold: "0.04"    # Lower threshold for 4H

      # Dynamic TP/SL - More aggressive for higher timeframe
      tp_atr_multiplier_sideways: "1.5"
      sl_atr_multiplier_sideways: "0.9"
      tp_atr_multiplier_weak: "2.0"
      tp_atr_multiplier_strong: "3.0"     # More aggressive on 4H
      sl_atr_multiplier_trend: "1.5"

      # Risk management
      risk_per_trade_pct: "0.015"         # 1.5% risk for higher timeframe
      max_position_size_usd: "5000"       # Larger positions for 4H
      max_daily_loss_usd: "500"
      max_positions: 2

      log_all_signals: true

    risk_management:
      max_position_size: "5000"
      stop_loss_percentage: null
      max_daily_loss: "500"
      min_order_size: "10"

    notifications:
      enabled: true
      telegram_bot_token: null
      telegram_chat_id: null
      notify_on_trade: true
      notify_on_error: true

    dry_run: false
    auto_start: false

# DEPLOYMENT CHECKLIST:
# [ ] Database setup: alembic upgrade head
# [ ] Credentials stored: Use bot CLI to add exchange credentials
# [ ] Encryption key: Set ENCRYPTION_KEY environment variable
# [ ] Telegram configured: Set TELEGRAM_BOT_TOKEN and TELEGRAM_ALLOWED_CHAT_IDS
# [ ] Test dry_run: Run with dry_run: true first
# [ ] Monitor logs: Check logs/ directory for any errors
# [ ] Set position limits: Verify max_position_size matches your capital
# [ ] Emergency procedures: Know how to stop bot via Telegram or /stop command
#
# RECOMMENDED: Start with small positions and gradually increase after verifying performance
